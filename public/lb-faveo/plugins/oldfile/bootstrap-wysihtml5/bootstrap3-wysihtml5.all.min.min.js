/*! bootstrap3-wysihtml5-bower 2013-11-22 */
var wysihtml5={version:"0.3.0",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};window.rangy=function(){function T(e,d){var f=typeof e[d];return f==K||!(f!=L||!e[d])||"unknown"==f}function S(d,c){return !(typeof d[c]!=L||!d[c])}function R(d,c){return typeof d[c]!=J}function Q(b){return function(a,f){for(var e=f.length;e--;){if(!b(a,f[e])){return !1}}return !0}}function P(b){return b&&E(b,F)&&C(b,G)}function O(b){window.alert("Rangy not supported in your browser. Reason: "+b),B.initialized=!0,B.supported=!1}function N(){if(!B.initialized){var f,e=!1,b=!1;for(T(document,"createRange")&&(f=document.createRange(),E(f,H)&&C(f,I)&&(e=!0),f.detach()),(f=S(document,"body")?document.body:document.getElementsByTagName("body")[0])&&T(f,"createTextRange")&&(f=f.createTextRange(),P(f)&&(b=!0)),!e&&!b&&O("Neither Range nor TextRange are implemented"),B.initialized=!0,B.features={implementsDomRange:e,implementsTextRange:b},e=z.concat(A),b=0,f=e.length;f>b;++b){try{e[b](B)}catch(a){S(window,"console")&&T(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",a)}}}}function M(b){this.name=b,this.supported=this.initialized=!1}var L="object",K="function",J="undefined",I="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),H="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),G="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),F="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),E=Q(T),D=Q(S),C=Q(R),B={version:"1.2.2",initialized:!1,supported:!0,util:{isHostMethod:T,isHostObject:S,isHostProperty:R,areHostMethods:E,areHostObjects:D,areHostProperties:C,isTextRange:P},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};B.fail=O,B.warn=function(b){b="Rangy warning: "+b,B.config.alertOnWarn?window.alert(b):typeof window.console!=J&&typeof window.console.log!=J&&window.console.log(b)},{}.hasOwnProperty?B.util.extend=function(e,d){for(var f in d){d.hasOwnProperty(f)&&(e[f]=d[f])}}:O("hasOwnProperty not supported");var A=[],z=[];B.init=N,B.addInitListener=function(b){B.initialized?b(B):A.push(b)};var y=[];B.addCreateMissingNativeApiListener=function(b){y.push(b)},B.createMissingNativeApi=function(e){e=e||window,N();for(var d=0,f=y.length;f>d;++d){y[d](e)}},M.prototype.fail=function(b){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+b)},M.prototype.warn=function(b){B.warn("Module "+this.name+": "+b)},M.prototype.createError=function(b){return Error("Error in Rangy "+this.name+" module: "+b)},B.createModule=function(e,d){var f=new M(e);B.modules[e]=f,z.push(function(b){d(b,f),f.initialized=!0,f.supported=!0})},B.requireModules=function(g){for(var f,j,i=0,h=g.length;h>i;++i){if(j=g[i],f=B.modules[j],!(f&&f instanceof M)){throw Error("Module '"+j+"' not found")}if(!f.supported){throw Error("Module '"+j+"' not supported")}}};var x=!1,D=function(){x||(x=!0,B.initialized||N())};if(typeof window==J){O("No window found")}else{if(typeof document!=J){return T(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",D,!1),T(window,"addEventListener")?window.addEventListener("load",D,!1):T(window,"attachEvent")?window.attachEvent("onload",D):O("Window does not have required addEventListener or attachEvent method"),B}O("No document found")}}(),rangy.createModule("DomUtil",function(F,E){function D(d){for(var c=0;d=d.previousSibling;){c++}return c}function C(f,e){var h,g=[];for(h=f;h;h=h.parentNode){g.push(h)}for(h=e;h;h=h.parentNode){if(q(g,h)){return h}}return null}function B(e,d,f){for(f=f?e:e.parentNode;f;){if(e=f.parentNode,e===d){return f}f=e}return null}function A(b){return b=b.nodeType,3==b||4==b||8==b}function z(f,e){var h=e.nextSibling,g=e.parentNode;return h?g.insertBefore(f,h):g.appendChild(f),f}function y(b){if(9==b.nodeType){return b}if(typeof b.ownerDocument!=t){return b.ownerDocument}if(typeof b.document!=t){return b.document}if(b.parentNode){return y(b.parentNode)}throw Error("getDocument: no document found for node")}function x(b){return b?A(b)?'"'+b.data+'"':1==b.nodeType?"<"+b.nodeName+(b.id?' id="'+b.id+'"':"")+">["+b.childNodes.length+"]":b.nodeName:"[No node]"}function w(b){this._next=this.root=b}function v(d,c){this.node=d,this.offset=c}function u(b){this.code=this[b],this.codeName=b,this.message="DOMException: "+this.codeName}var t="undefined",s=F.util;s.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||E.fail("document missing a Node creation method"),s.isHostMethod(document,"getElementsByTagName")||E.fail("document missing getElementsByTagName method");var r=document.createElement("div");s.areHostMethods(r,["insertBefore","appendChild","cloneNode"])||E.fail("Incomplete Element implementation"),s.isHostProperty(r,"innerHTML")||E.fail("Element is missing innerHTML property"),r=document.createTextNode("test"),s.areHostMethods(r,["splitText","deleteData","insertData","appendData","cloneNode"])||E.fail("Incomplete Text Node implementation");var q=function(e,d){for(var f=e.length;f--;){if(e[f]===d){return !0}}return !1};w.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){var d,c=this._current=this._next;if(this._current){if(d=c.firstChild,!d){for(d=null;c!==this.root&&!(d=c.nextSibling);){c=c.parentNode}}this._next=d}return this._current},detach:function(){this._current=this._next=this.root=null}},v.prototype={equals:function(b){return this.node===b.node&this.offset==b.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"}},u.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},u.prototype.toString=function(){return this.message},F.dom={arrayContains:q,isHtmlNamespace:function(d){var c;return typeof d.namespaceURI==t||null===(c=d.namespaceURI)||"http://www.w3.org/1999/xhtml"==c},parentElement:function(b){return b=b.parentNode,1==b.nodeType?b:null},getNodeIndex:D,getNodeLength:function(d){var c;return A(d)?d.length:(c=d.childNodes)?c.length:0},getCommonAncestor:C,isAncestorOf:function(e,d,f){for(d=f?d:d.parentNode;d;){if(d===e){return !0}d=d.parentNode}return !1},getClosestAncestorIn:B,isCharacterDataNode:A,insertAfter:z,splitDataNode:function(e,d){var f=e.cloneNode(!1);return f.deleteData(0,d),e.deleteData(d,e.length-d),z(f,e),f},getDocument:y,getWindow:function(b){if(b=y(b),typeof b.defaultView!=t){return b.defaultView}if(typeof b.parentWindow!=t){return b.parentWindow}throw Error("Cannot get a window object for node")},getIframeWindow:function(b){if(typeof b.contentWindow!=t){return b.contentWindow}if(typeof b.contentDocument!=t){return b.contentDocument.defaultView}throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(b){if(typeof b.contentDocument!=t){return b.contentDocument}if(typeof b.contentWindow!=t){return b.contentWindow.document}throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(b){return s.isHostObject(b,"body")?b.body:b.getElementsByTagName("body")[0]},getRootContainer:function(d){for(var c;c=d.parentNode;){d=c}return d},comparePoints:function(d,c,j,i){var e;if(d==j){return c===i?0:i>c?-1:1}if(e=B(j,d,!0)){return c<=D(e)?-1:1}if(e=B(d,j,!0)){return D(e)<i?-1:1}if(c=C(d,j),d=d===c?c:B(d,c,!0),j=j===c?c:B(j,c,!0),d===j){throw Error("comparePoints got to case 4 and childA and childB are the same!")}for(c=c.firstChild;c;){if(c===d){return -1}if(c===j){return 1}c=c.nextSibling}throw Error("Should not be here!")},inspectNode:x,fragmentFromNodeChildren:function(e){for(var d,f=y(e).createDocumentFragment();d=e.firstChild;){f.appendChild(d)}return f},createIterator:function(b){return new w(b)},DomPosition:v},F.DOMException=u}),rangy.createModule("DomRange",function(a3){function a2(d,c){return 3!=d.nodeType&&(au.isAncestorOf(d,c.startContainer,!0)||au.isAncestorOf(d,c.endContainer,!0))}function a1(b){return au.getDocument(b.startContainer)}function a0(g,f,j){if(f=g._listeners[f]){for(var i=0,h=f.length;h>i;++i){f[i].call(g,{target:g,args:j})}}}function aZ(b){return new at(b.parentNode,au.getNodeIndex(b))}function aY(b){return new at(b.parentNode,au.getNodeIndex(b)+1)}function aX(f,e,h){var g=11==f.nodeType?f.firstChild:f;return au.isCharacterDataNode(e)?h==e.length?au.insertAfter(f,e):e.parentNode.insertBefore(f,0==h?e:au.splitDataNode(e,h)):h>=e.childNodes.length?e.appendChild(f):e.insertBefore(f,e.childNodes[h]),g}function aW(f){for(var c,h,g=a1(f.range).createDocumentFragment();h=f.next();){if(c=f.isPartiallySelectedSubtree(),h=h.cloneNode(!c),c&&(c=f.getSubtreeIterator(),h.appendChild(aW(c)),c.detach(!0)),10==h.nodeType){throw new ar("HIERARCHY_REQUEST_ERR")}g.appendChild(h)}return g}function aV(g,f,j){for(var i,h,j=j||{stop:!1};i=g.next();){if(g.isPartiallySelectedSubtree()){if(!1===f(i)){j.stop=!0;break}if(i=g.getSubtreeIterator(),aV(i,f,j),i.detach(!0),j.stop){break}}else{for(i=au.createIterator(i);h=i.next();){if(!1===f(h)){return j.stop=!0,void 0}}}}}function aU(d){for(var c;d.next();){d.isPartiallySelectedSubtree()?(c=d.getSubtreeIterator(),aU(c),c.detach(!0)):d.remove()}}function aT(f){for(var c,h,g=a1(f.range).createDocumentFragment();c=f.next();){if(f.isPartiallySelectedSubtree()?(c=c.cloneNode(!1),h=f.getSubtreeIterator(),c.appendChild(aT(h)),h.detach(!0)):f.remove(),10==c.nodeType){throw new ar("HIERARCHY_REQUEST_ERR")}g.appendChild(c)}return g}function aS(i,h,n){var m,l=!(!h||!h.length),k=!!n;l&&(m=RegExp("^("+h.join("|")+")$"));var j=[];return aV(new aQ(i,!1),function(b){(!l||m.test(b.nodeType))&&(!k||n(b))&&j.push(b)}),j}function aR(b){return"["+("undefined"==typeof b.getName?"Range":b.getName())+"("+au.inspectNode(b.startContainer)+":"+b.startOffset+", "+au.inspectNode(b.endContainer)+":"+b.endOffset+")]"}function aQ(e,d){if(this.range=e,this.clonePartiallySelectedTextNodes=d,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var f=e.commonAncestorContainer;this.sc===this.ec&&au.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==f||au.isCharacterDataNode(this.sc)?au.getClosestAncestorIn(this.sc,f,!0):this.sc.childNodes[this.so],this._last=this.ec!==f||au.isCharacterDataNode(this.ec)?au.getClosestAncestorIn(this.ec,f,!0):this.ec.childNodes[this.eo-1])}}function aP(b){this.code=this[b],this.codeName=b,this.message="RangeException: "+this.codeName}function aO(e,d,f){this.nodes=aS(e,d,f),this._next=this.nodes[0],this._position=0}function aN(b){return function(a,h){for(var g,f=h?a:a.parentNode;f;){if(g=f.nodeType,au.arrayContains(b,g)){return f}f=f.parentNode}return null}}function aM(d,c){if(aj(d,c)){throw new aP("INVALID_NODE_TYPE_ERR")}}function aL(b){if(!b.startContainer){throw new ar("INVALID_STATE_ERR")}}function aK(d,c){if(!au.arrayContains(c,d.nodeType)){throw new aP("INVALID_NODE_TYPE_ERR")}}function aJ(d,c){if(0>c||c>(au.isCharacterDataNode(d)?d.length:d.childNodes.length)){throw new ar("INDEX_SIZE_ERR")}}function aI(d,c){if(al(d,!0)!==al(c,!0)){throw new ar("WRONG_DOCUMENT_ERR")}}function aH(b){if(ak(b,!0)){throw new ar("NO_MODIFICATION_ALLOWED_ERR")}}function aG(d,c){if(!d){throw new ar(c)}}function aF(b){if(aL(b),!((au.arrayContains(ap,b.startContainer.nodeType)||al(b.startContainer,!0))&&(au.arrayContains(ap,b.endContainer.nodeType)||al(b.endContainer,!0))&&b.startOffset<=(au.isCharacterDataNode(b.startContainer)?b.startContainer.length:b.startContainer.childNodes.length)&&b.endOffset<=(au.isCharacterDataNode(b.endContainer)?b.endContainer.length:b.endContainer.childNodes.length))){throw Error("Range error: Range is no longer valid after DOM mutation ("+b.inspect()+")")}}function aE(){}function aC(b){b.START_TO_START=ae,b.START_TO_END=ad,b.END_TO_END=ac,b.END_TO_START=aa,b.NODE_BEFORE=aD,b.NODE_AFTER=a5,b.NODE_BEFORE_AND_AFTER=aB,b.NODE_INSIDE=a4}function aA(b){aC(b),aC(b.prototype)}function az(d,c){return function(){aF(this);var h=this.startContainer,f=this.startOffset,b=this.commonAncestorContainer,a=new aQ(this,!0);return h!==b&&(h=au.getClosestAncestorIn(h,b,!0),f=aY(h),h=f.node,f=f.offset),aV(a,aH),a.reset(),b=d(a),a.detach(),c(this,h,f,h,f),b}}function ay(k,j,f){function e(d,c){return function(g){aL(this),aK(g,aq),aK(am(g),ap),g=(d?aZ:aY)(g),(c?b:a)(this,g.node,g.offset)}}function b(g,d,l){var i=g.endContainer,h=g.endOffset;(d!==g.startContainer||l!==g.startOffset)&&((am(d)!=am(i)||1==au.comparePoints(d,l,i,h))&&(i=d,h=l),j(g,d,l,i,h))}function a(g,d,l){var i=g.startContainer,h=g.startOffset;(d!==g.endContainer||l!==g.endOffset)&&((am(d)!=am(i)||-1==au.comparePoints(d,l,i,h))&&(i=d,h=l),j(g,i,h,d,l))}k.prototype=new aE,a3.util.extend(k.prototype,{setStart:function(d,c){aL(this),aM(d,!0),aJ(d,c),b(this,d,c)},setEnd:function(d,c){aL(this),aM(d,!0),aJ(d,c),a(this,d,c)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(c){aF(this),c?j(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):j(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(c){aL(this),aM(c,!0),j(this,c,0,c,au.getNodeLength(c))},selectNode:function(d){aL(this),aM(d,!1),aK(d,aq);var c=aZ(d),d=aY(d);j(this,c.node,c.offset,d.node,d.offset)},extractContents:az(aT,j),deleteContents:az(aU,j),canSurroundContents:function(){aF(this),aH(this.startContainer),aH(this.endContainer);var d=new aQ(this,!0),g=d._first&&a2(d._first,this)||d._last&&a2(d._last,this);return d.detach(),!g},detach:function(){f(this)},splitBoundaries:function(){aF(this);var g=this.startContainer,d=this.startOffset,l=this.endContainer,i=this.endOffset,h=g===l;au.isCharacterDataNode(l)&&i>0&&i<l.length&&au.splitDataNode(l,i),au.isCharacterDataNode(g)&&d>0&&d<g.length&&(g=au.splitDataNode(g,d),h?(i-=d,l=g):l==g.parentNode&&i>=au.getNodeIndex(g)&&i++,d=0),j(this,g,d,l,i)},normalizeBoundaries:function(){aF(this);var i=this.startContainer,d=this.startOffset,p=this.endContainer,o=this.endOffset,n=function(g){var c=g.nextSibling;c&&c.nodeType==g.nodeType&&(p=g,o=g.length,g.appendData(c.data),c.parentNode.removeChild(c))},m=function(q){var h=q.previousSibling;if(h&&h.nodeType==q.nodeType){i=q;var c=q.length;d=h.length,q.insertData(0,h.data),h.parentNode.removeChild(h),i==p?(o+=d,p=i):p==q.parentNode&&(h=au.getNodeIndex(q),o==h?(p=q,o=c):o>h&&o--)}},l=!0;au.isCharacterDataNode(p)?p.length==o&&n(p):(o>0&&(l=p.childNodes[o-1])&&au.isCharacterDataNode(l)&&n(l),l=!this.collapsed),l?au.isCharacterDataNode(i)?0==d&&m(i):d<i.childNodes.length&&(n=i.childNodes[d])&&au.isCharacterDataNode(n)&&m(n):(i=p,d=o),j(this,i,d,p,o)},collapseToPoint:function(d,c){aL(this),aM(d,!0),aJ(d,c),(d!==this.startContainer||c!==this.startOffset||d!==this.endContainer||c!==this.endOffset)&&j(this,d,c,d,c)}}),aA(k)}function ax(b){b.collapsed=b.startContainer===b.endContainer&&b.startOffset===b.endOffset,b.commonAncestorContainer=b.collapsed?b.startContainer:au.getCommonAncestor(b.startContainer,b.endContainer)}function aw(i,d,n,m,l){var k=i.startContainer!==d||i.startOffset!==n,j=i.endContainer!==m||i.endOffset!==l;i.startContainer=d,i.startOffset=n,i.endContainer=m,i.endOffset=l,ax(i),a0(i,"boundarychange",{startMoved:k,endMoved:j})}function av(b){this.startContainer=b,this.startOffset=0,this.endContainer=b,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},ax(this)}a3.requireModules(["DomUtil"]);var au=a3.dom,at=au.DomPosition,ar=a3.DOMException;aQ.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return !!this._next},next:function(){var b=this._current=this._next;return b&&(this._next=b!==this._last?b.nextSibling:null,au.isCharacterDataNode(b)&&this.clonePartiallySelectedTextNodes&&(b===this.ec&&(b=b.cloneNode(!0)).deleteData(this.eo,b.length-this.eo),this._current===this.sc&&(b=b.cloneNode(!0)).deleteData(0,this.so))),b},remove:function(){var e,d,f=this._current;!au.isCharacterDataNode(f)||f!==this.sc&&f!==this.ec?f.parentNode&&f.parentNode.removeChild(f):(e=f===this.sc?this.so:0,d=f===this.ec?this.eo:f.length,e!=d&&f.deleteData(e,d-e))},isPartiallySelectedSubtree:function(){return a2(this._current,this.range)},getSubtreeIterator:function(){var h;if(this.isSingleCharacterDataNode){h=this.range.cloneRange(),h.collapse()}else{h=new av(a1(this.range));var c=this._current,l=c,k=0,j=c,i=au.getNodeLength(c);au.isAncestorOf(c,this.sc,!0)&&(l=this.sc,k=this.so),au.isAncestorOf(c,this.ec,!0)&&(j=this.ec,i=this.eo),aw(h,l,k,j,i)}return new aQ(h,this.clonePartiallySelectedTextNodes)},detach:function(b){b&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},aP.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},aP.prototype.toString=function(){return this.message},aO.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var aq=[1,3,4,5,7,8,10],ap=[2,9,11],ao=[1,3,4,5,7,8,10,11],an=[1,3,4,5,7,8],am=au.getRootContainer,al=aN([9,11]),ak=aN([5,6,10,12]),aj=aN([6,10,12]),ai=document.createElement("style"),ah=!1;try{ai.innerHTML="<b>x</b>",ah=3==ai.firstChild.nodeType}catch(ag){}a3.features.htmlParsingConforms=ah;var af="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),ae=0,ad=1,ac=2,aa=3,aD=0,a5=1,aB=2,a4=3;aE.prototype={attachListener:function(d,c){this._listeners[d].push(c)},compareBoundaryPoints:function(f,e){aF(this),aI(this.startContainer,e.startContainer);var h=f==aa||f==ae?"start":"end",g=f==ad||f==ae?"start":"end";return au.comparePoints(this[h+"Container"],this[h+"Offset"],e[g+"Container"],e[g+"Offset"])},insertNode:function(b){if(aF(this),aK(b,ao),aH(this.startContainer),au.isAncestorOf(b,this.startContainer,!0)){throw new ar("HIERARCHY_REQUEST_ERR")}this.setStartBefore(aX(b,this.startContainer,this.startOffset))},cloneContents:function(){aF(this);var d,c;return this.collapsed?a1(this).createDocumentFragment():this.startContainer===this.endContainer&&au.isCharacterDataNode(this.startContainer)?(d=this.startContainer.cloneNode(!0),d.data=d.data.slice(this.startOffset,this.endOffset),c=a1(this).createDocumentFragment(),c.appendChild(d),c):(c=new aQ(this,!0),d=aW(c),c.detach(),d)},canSurroundContents:function(){aF(this),aH(this.startContainer),aH(this.endContainer);var b=new aQ(this,!0),d=b._first&&a2(b._first,this)||b._last&&a2(b._last,this);return b.detach(),!d},surroundContents:function(d){if(aK(d,an),!this.canSurroundContents()){throw new aP("BAD_BOUNDARYPOINTS_ERR")}var c=this.extractContents();if(d.hasChildNodes()){for(;d.lastChild;){d.removeChild(d.lastChild)}}aX(d,this.startContainer,this.startOffset),d.appendChild(c),this.selectNode(d)},cloneRange:function(){aF(this);for(var e,c=new av(a1(this)),f=af.length;f--;){e=af[f],c[e]=this[e]}return c},toString:function(){aF(this);var d=this.startContainer;if(d===this.endContainer&&au.isCharacterDataNode(d)){return 3==d.nodeType||4==d.nodeType?d.data.slice(this.startOffset,this.endOffset):""}var c=[],d=new aQ(this,!0);return aV(d,function(b){(3==b.nodeType||4==b.nodeType)&&c.push(b.data)}),d.detach(),c.join("")},compareNode:function(e){aF(this);var d=e.parentNode,f=au.getNodeIndex(e);if(!d){throw new ar("NOT_FOUND_ERR")}return e=this.comparePoint(d,f),d=this.comparePoint(d,f+1),0>e?d>0?aB:aD:d>0?a5:a4},comparePoint:function(d,c){return aF(this),aG(d,"HIERARCHY_REQUEST_ERR"),aI(d,this.startContainer),0>au.comparePoints(d,c,this.startContainer,this.startOffset)?-1:0<au.comparePoints(d,c,this.endContainer,this.endOffset)?1:0},createContextualFragment:ah?function(f){var e=this.startContainer,h=au.getDocument(e);if(!e){throw new ar("INVALID_STATE_ERR")}var g=null;return 1==e.nodeType?g=e:au.isCharacterDataNode(e)&&(g=au.parentElement(e)),g=null===g||"HTML"==g.nodeName&&au.isHtmlNamespace(au.getDocument(g).documentElement)&&au.isHtmlNamespace(g)?h.createElement("body"):g.cloneNode(!1),g.innerHTML=f,au.fragmentFromNodeChildren(g)}:function(d){aL(this);var c=a1(this).createElement("body");return c.innerHTML=d,au.fragmentFromNodeChildren(c)},toHtml:function(){aF(this);var b=a1(this).createElement("div");return b.appendChild(this.cloneContents()),b.innerHTML},intersectsNode:function(g,c){if(aF(this),aG(g,"NOT_FOUND_ERR"),au.getDocument(g)!==a1(this)){return !1}var j=g.parentNode,i=au.getNodeIndex(g);aG(j,"NOT_FOUND_ERR");var h=au.comparePoints(j,i,this.endContainer,this.endOffset),j=au.comparePoints(j,i+1,this.startContainer,this.startOffset);return c?0>=h&&j>=0:0>h&&j>0},isPointInRange:function(d,c){return aF(this),aG(d,"HIERARCHY_REQUEST_ERR"),aI(d,this.startContainer),0<=au.comparePoints(d,c,this.startContainer,this.startOffset)&&0>=au.comparePoints(d,c,this.endContainer,this.endOffset)},intersectsRange:function(f,c){if(aF(this),a1(f)!=a1(this)){throw new ar("WRONG_DOCUMENT_ERR")}var h=au.comparePoints(this.startContainer,this.startOffset,f.endContainer,f.endOffset),g=au.comparePoints(this.endContainer,this.endOffset,f.startContainer,f.startOffset);return c?0>=h&&g>=0:0>h&&g>0},intersection:function(f){if(this.intersectsRange(f)){var e=au.comparePoints(this.startContainer,this.startOffset,f.startContainer,f.startOffset),h=au.comparePoints(this.endContainer,this.endOffset,f.endContainer,f.endOffset),g=this.cloneRange();return -1==e&&g.setStart(f.startContainer,f.startOffset),1==h&&g.setEnd(f.endContainer,f.endOffset),g}return null},union:function(d){if(this.intersectsRange(d,!0)){var c=this.cloneRange();return -1==au.comparePoints(d.startContainer,d.startOffset,this.startContainer,this.startOffset)&&c.setStart(d.startContainer,d.startOffset),1==au.comparePoints(d.endContainer,d.endOffset,this.endContainer,this.endOffset)&&c.setEnd(d.endContainer,d.endOffset),c}throw new aP("Ranges do not intersect")},containsNode:function(d,c){return c?this.intersectsNode(d,!1):this.compareNode(d)==a4},containsNodeContents:function(b){return 0<=this.comparePoint(b,0)&&0>=this.comparePoint(b,au.getNodeLength(b))},containsRange:function(b){return this.intersection(b).equals(b)},containsNodeText:function(e){var d=this.cloneRange();d.selectNode(e);var f=d.getNodes([3]);return 0<f.length?(d.setStart(f[0],0),e=f.pop(),d.setEnd(e,e.length),e=this.containsRange(d),d.detach(),e):this.containsNodeContents(e)},createNodeIterator:function(d,c){return aF(this),new aO(this,d,c)},getNodes:function(d,c){return aF(this),aS(this,d,c)},getDocument:function(){return a1(this)},collapseBefore:function(b){aL(this),this.setEndBefore(b),this.collapse(!1)},collapseAfter:function(b){aL(this),this.setStartAfter(b),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(b){return av.rangesEqual(this,b)},inspect:function(){return aR(this)}},ay(av,aw,function(b){aL(b),b.startContainer=b.startOffset=b.endContainer=b.endOffset=null,b.collapsed=b.commonAncestorContainer=null,a0(b,"detach",null),b._listeners=null}),a3.rangePrototype=aE.prototype,av.rangeProperties=af,av.RangeIterator=aQ,av.copyComparisonConstants=aA,av.createPrototypeRange=ay,av.inspect=aR,av.getRangeDocument=a1,av.rangesEqual=function(d,c){return d.startContainer===c.startContainer&&d.startOffset===c.startOffset&&d.endContainer===c.endContainer&&d.endOffset===c.endOffset},a3.DomRange=av,a3.RangeException=aP}),rangy.createModule("WrappedRange",function(j){function i(f,e,v,u){var t=f.duplicate();t.collapse(v);var s=t.parentElement();if(n.isAncestorOf(e,s,!0)||(s=e),!s.canHaveHTML){return new m(s.parentNode,n.getNodeIndex(s))}var r,e=n.getDocument(s).createElement("span"),q=v?"StartToStart":"StartToEnd";do{s.insertBefore(e,e.previousSibling),t.moveToElementText(e)}while(0<(r=t.compareEndPoints(q,f))&&e.previousSibling);if(q=e.nextSibling,-1==r&&q&&n.isCharacterDataNode(q)){if(t.setEndPoint(v?"EndToStart":"EndToEnd",f),/[\r\n]/.test(q.data)){for(s=t.duplicate(),v=s.text.replace(/\r\n/g,"\r").length,v=s.moveStart("character",v);-1==s.compareEndPoints("StartToEnd",s);){v++,s.moveStart("character",1)}}else{v=t.text.length}s=new m(q,v)}else{q=(u||!v)&&e.previousSibling,s=(v=(u||v)&&e.nextSibling)&&n.isCharacterDataNode(v)?new m(v,0):q&&n.isCharacterDataNode(q)?new m(q,q.length):new m(s,n.getNodeIndex(e))}return e.parentNode.removeChild(e),s}function p(q,e){var w,v,u=q.offset,t=n.getDocument(q.node),s=t.body.createTextRange(),r=n.isCharacterDataNode(q.node);return r?(w=q.node,v=w.parentNode):(w=q.node.childNodes,w=u<w.length?w[u]:null,v=q.node),t=t.createElement("span"),t.innerHTML="&#feff;",w?v.insertBefore(t,w):v.appendChild(t),s.moveToElementText(t),s.collapse(!e),v.removeChild(t),r&&s[e?"moveStart":"moveEnd"]("character",u),s}j.requireModules(["DomUtil","DomRange"]);var o,n=j.dom,m=n.DomPosition,l=j.DomRange;if(!j.features.implementsDomRange||j.features.implementsTextRange&&j.config.preferTextRange){if(j.features.implementsTextRange){o=function(b){this.textRange=b,this.refresh()},o.prototype=new l(document),o.prototype.refresh=function(){var b,h,g=this.textRange;b=g.parentElement();var e=g.duplicate();e.collapse(!0),h=e.parentElement(),e=g.duplicate(),e.collapse(!1),g=e.parentElement(),h=h==g?h:n.getCommonAncestor(h,g),h=h==b?h:n.getCommonAncestor(b,h),0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?h=b=i(this.textRange,h,!0,!0):(b=i(this.textRange,h,!0,!1),h=i(this.textRange,h,!1,!1)),this.setStart(b.node,b.offset),this.setEnd(h.node,h.offset)},l.copyComparisonConstants(o);var k=function(){return this}();"undefined"==typeof k.Range&&(k.Range=o),j.createNativeRange=function(b){return b=b||document,b.body.createTextRange()}}}else{(function(){function a(h){for(var f,t=q.length;t--;){f=q[t],h[f]=h.nativeRange[f]}}var s,r,q=l.rangeProperties;o=function(b){if(!b){throw Error("Range must be specified")}this.nativeRange=b,a(this)},l.createPrototypeRange(o,function(t,h,x,w,v){var u=t.endContainer!==w||t.endOffset!=v;(t.startContainer!==h||t.startOffset!=x||u)&&(t.setEnd(w,v),t.setStart(h,x))},function(h){h.nativeRange.detach(),h.detached=!0;for(var f,t=q.length;t--;){f=q[t],h[f]=null}}),s=o.prototype,s.selectNode=function(b){this.nativeRange.selectNode(b),a(this)},s.deleteContents=function(){this.nativeRange.deleteContents(),a(this)},s.extractContents=function(){var b=this.nativeRange.extractContents();return a(this),b},s.cloneContents=function(){return this.nativeRange.cloneContents()},s.surroundContents=function(b){this.nativeRange.surroundContents(b),a(this)},s.collapse=function(b){this.nativeRange.collapse(b),a(this)},s.cloneRange=function(){return new o(this.nativeRange.cloneRange())},s.refresh=function(){a(this)},s.toString=function(){return this.nativeRange.toString()};var g=document.createTextNode("test");n.getBody(document).appendChild(g);var e=document.createRange();e.setStart(g,0),e.setEnd(g,0);try{e.setStart(g,1),s.setStart=function(b,f){this.nativeRange.setStart(b,f),a(this)},s.setEnd=function(b,f){this.nativeRange.setEnd(b,f),a(this)},r=function(b){return function(f){this.nativeRange[b](f),a(this)}}}catch(d){s.setStart=function(b,h){try{this.nativeRange.setStart(b,h)}catch(f){this.nativeRange.setEnd(b,h),this.nativeRange.setStart(b,h)}a(this)},s.setEnd=function(b,h){try{this.nativeRange.setEnd(b,h)}catch(f){this.nativeRange.setStart(b,h),this.nativeRange.setEnd(b,h)}a(this)},r=function(b,f){return function(h){try{this.nativeRange[b](h)}catch(c){this.nativeRange[f](h),this.nativeRange[b](h)}a(this)}}}s.setStartBefore=r("setStartBefore","setEndBefore"),s.setStartAfter=r("setStartAfter","setEndAfter"),s.setEndBefore=r("setEndBefore","setStartBefore"),s.setEndAfter=r("setEndAfter","setStartAfter"),e.selectNodeContents(g),s.selectNodeContents=e.startContainer==g&&e.endContainer==g&&0==e.startOffset&&e.endOffset==g.length?function(b){this.nativeRange.selectNodeContents(b),a(this)}:function(b){this.setStart(b,0),this.setEnd(b,l.getEndOffset(b))},e.selectNodeContents(g),e.setEnd(g,3),r=document.createRange(),r.selectNodeContents(g),r.setEnd(g,4),r.setStart(g,2),s.compareBoundaryPoints=-1==e.compareBoundaryPoints(e.START_TO_END,r)&1==e.compareBoundaryPoints(e.END_TO_START,r)?function(f,c){return c=c.nativeRange||c,f==c.START_TO_END?f=c.END_TO_START:f==c.END_TO_START&&(f=c.START_TO_END),this.nativeRange.compareBoundaryPoints(f,c)}:function(f,c){return this.nativeRange.compareBoundaryPoints(f,c.nativeRange||c)},j.util.isHostMethod(e,"createContextualFragment")&&(s.createContextualFragment=function(b){return this.nativeRange.createContextualFragment(b)}),n.getBody(document).removeChild(g),e.detach(),r.detach()})(),j.createNativeRange=function(b){return b=b||document,b.createRange()}}j.features.implementsTextRange&&(o.rangeToTextRange=function(e){if(e.collapsed){return p(new m(e.startContainer,e.startOffset),!0)}var c=p(new m(e.startContainer,e.startOffset),!0),f=p(new m(e.endContainer,e.endOffset),!1),e=n.getDocument(e.startContainer).body.createTextRange();return e.setEndPoint("StartToStart",c),e.setEndPoint("EndToEnd",f),e}),o.prototype.getName=function(){return"WrappedRange"},j.WrappedRange=o,j.createRange=function(a){return a=a||document,new o(j.createNativeRange(a))},j.createRangyRange=function(b){return b=b||document,new l(b)},j.createIframeRange=function(a){return j.createRange(n.getIframeDocument(a))},j.createIframeRangyRange=function(a){return j.createRangyRange(n.getIframeDocument(a))},j.addCreateMissingNativeApiListener(function(a){a=a.document,"undefined"==typeof a.createRange&&(a.createRange=function(){return j.createRange(this)}),a=a=null})}),rangy.createModule("WrappedSelection",function(aC,aB){function aA(b){return(b||window).getSelection()}function az(b){return(b||window).document.selection}function ay(f,e,h){var g=h?"end":"start",h=h?"start":"end";f.anchorNode=e[g+"Container"],f.anchorOffset=e[g+"Offset"],f.focusNode=e[h+"Container"],f.focusOffset=e[h+"Offset"]}function ax(b){b.anchorNode=b.focusNode=null,b.anchorOffset=b.focusOffset=0,b.rangeCount=0,b.isCollapsed=!0,b._ranges.length=0}function aw(a){var d;return a instanceof ai?(d=a._selectionNativeRange,d||(d=aC.createNativeRange(ak.getDocument(a.startContainer)),d.setEnd(a.endContainer,a.endOffset),d.setStart(a.startContainer,a.startOffset),a._selectionNativeRange=d,a.attachListener("detach",function(){this._selectionNativeRange=null}))):a instanceof ah?d=a.nativeRange:aC.features.implementsDomRange&&a instanceof ak.getWindow(a.startContainer).Range&&(d=a),d}function av(f){var e,h=f.getNodes();f:if(h.length&&1==h[0].nodeType){e=1;for(var g=h.length;g>e;++e){if(!ak.isAncestorOf(h[0],h[e])){e=!1;break f}}e=!0}else{e=!1}if(!e){throw Error("getSingleElementFromRange: range "+f.inspect()+" did not consist of a single element")}return h[0]}function au(e,d){var f=new ah(d);e._ranges=[f],ay(e,f,!1),e.rangeCount=1,e.isCollapsed=f.collapsed}function at(a){if(a._ranges.length=0,"None"==a.docSelection.type){ax(a)}else{var j=a.docSelection.createRange();if(j&&"undefined"!=typeof j.text){au(a,j)}else{a.rangeCount=j.length;for(var i,f=ak.getDocument(j.item(0)),e=0;e<a.rangeCount;++e){i=aC.createRange(f),i.selectNode(j.item(e)),a._ranges.push(i)}a.isCollapsed=1==a.rangeCount&&a._ranges[0].collapsed,ay(a,a._ranges[a.rangeCount-1],!1)}}}function ar(j,h){for(var p=j.docSelection.createRange(),o=av(h),n=ak.getDocument(p.item(0)),n=ak.getBody(n).createControlRange(),m=0,l=p.length;l>m;++m){n.add(p.item(m))}try{n.add(o)}catch(k){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}n.select(),at(j)}function aq(e,d,f){this.nativeSelection=e,this.docSelection=d,this._ranges=[],this.win=f,this.refresh()}function ap(h,g){for(var l,k=ak.getDocument(g[0].startContainer),k=ak.getBody(k).createControlRange(),j=0;rangeCount>j;++j){l=av(g[j]);try{k.add(l)}catch(i){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}k.select(),at(h)}function ao(d,c){if(d.anchorNode&&ak.getDocument(d.anchorNode)!==ak.getDocument(c)){throw new ag("WRONG_DOCUMENT_ERR")}}function an(i){var h=[],n=new af(i.anchorNode,i.anchorOffset),m=new af(i.focusNode,i.focusOffset),l="function"==typeof i.getName?i.getName():"Selection";if("undefined"!=typeof i.rangeCount){for(var k=0,j=i.rangeCount;j>k;++k){h[k]=ai.inspect(i.getRangeAt(k))}}return"["+l+"(Ranges: "+h.join(", ")+")(anchor: "+n.inspect()+", focus: "+m.inspect()+"]"}aC.requireModules(["DomUtil","DomRange","WrappedRange"]),aC.config.checkSelectionRanges=!0;var am,al,ak=aC.dom,aj=aC.util,ai=aC.DomRange,ah=aC.WrappedRange,ag=aC.DOMException,af=ak.DomPosition,ae=aC.util.isHostMethod(window,"getSelection"),ad=aC.util.isHostObject(document,"selection"),ac=ad&&(!ae||aC.config.preferTextRange);ac?(am=az,aC.isSelectionValid=function(d){var d=(d||window).document,c=d.selection;return"None"!=c.type||ak.getDocument(c.createRange().parentElement())==d}):ae?(am=aA,aC.isSelectionValid=function(){return !0}):aB.fail("Neither document.selection or window.getSelection() detected."),aC.getNativeSelection=am;var ae=am(),ab=aC.createNativeRange(document),aa=ak.getBody(document),Z=aj.areHostObjects(ae,aj.areHostProperties(ae,["anchorOffset","focusOffset"]));aC.features.selectionHasAnchorAndFocus=Z;var Y=aj.isHostMethod(ae,"extend");aC.features.selectionHasExtend=Y;var X="number"==typeof ae.rangeCount;aC.features.selectionHasRangeCount=X;var W=!1,V=!0;aj.areHostMethods(ae,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof ae.rangeCount&&aC.features.implementsDomRange&&function(){var g=document.createElement("iframe");aa.appendChild(g);var f=ak.getIframeDocument(g);f.open(),f.write("<html><head></head><body>12</body></html>"),f.close();var j=ak.getIframeWindow(g).getSelection(),i=f.documentElement.lastChild.firstChild,f=f.createRange();f.setStart(i,1),f.collapse(!0),j.addRange(f),V=1==j.rangeCount,j.removeAllRanges();var h=f.cloneRange();f.setStart(i,0),h.setEnd(i,2),j.addRange(f),j.addRange(h),W=2==j.rangeCount,f.detach(),h.detach(),aa.removeChild(g)}(),aC.features.selectionSupportsMultipleRanges=W,aC.features.collapsedNonEditableSelectionsSupported=V;var U,T=!1;aa&&aj.isHostMethod(aa,"createControlRange")&&(U=aa.createControlRange(),aj.areHostProperties(U,["item","add"])&&(T=!0)),aC.features.implementsControlRange=T,al=Z?function(b){return b.anchorNode===b.focusNode&&b.anchorOffset===b.focusOffset}:function(b){return b.rangeCount?b.getRangeAt(b.rangeCount-1).collapsed:!1};var S;if(aj.isHostMethod(ae,"getRangeAt")?S=function(e,d){try{return e.getRangeAt(d)}catch(f){return null}}:Z&&(S=function(a){var d=ak.getDocument(a.anchorNode),d=aC.createRange(d);return d.setStart(a.anchorNode,a.anchorOffset),d.setEnd(a.focusNode,a.focusOffset),d.collapsed!==this.isCollapsed&&(d.setStart(a.focusNode,a.focusOffset),d.setEnd(a.anchorNode,a.anchorOffset)),d}),aC.getSelection=function(f){var f=f||window,d=f._rangySelection,h=am(f),g=ad?az(f):null;return d?(d.nativeSelection=h,d.docSelection=g,d.refresh(f)):(d=new aq(h,g,f),f._rangySelection=d),d},aC.getIframeSelection=function(a){return aC.getSelection(ak.getIframeWindow(a))},U=aq.prototype,!ac&&Z&&aj.areHostMethods(ae,["removeAllRanges","addRange"])){U.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),ax(this)};var R=function(a,f){var e=ai.getRangeDocument(f),e=aC.createRange(e);e.collapseToPoint(f.endContainer,f.endOffset),a.nativeSelection.addRange(aw(e)),a.nativeSelection.extend(f.startContainer,f.startOffset),a.refresh()};U.addRange=X?function(a,f){if(T&&ad&&"Control"==this.docSelection.type){ar(this,a)}else{if(f&&Y){R(this,a)}else{var e;W?e=this.rangeCount:(this.removeAllRanges(),e=0),this.nativeSelection.addRange(aw(a)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1?(aC.config.checkSelectionRanges&&(e=S(this.nativeSelection,this.rangeCount-1))&&!ai.rangesEqual(e,a)&&(a=new ah(e)),this._ranges[this.rangeCount-1]=a,ay(this,a,O(this.nativeSelection)),this.isCollapsed=al(this)):this.refresh()}}}:function(d,c){c&&Y?R(this,d):(this.nativeSelection.addRange(aw(d)),this.refresh())},U.setRanges=function(e){if(T&&e.length>1){ap(this,e)}else{this.removeAllRanges();for(var d=0,f=e.length;f>d;++d){this.addRange(e[d])}}}}else{if(!(aj.isHostMethod(ae,"empty")&&aj.isHostMethod(ab,"select")&&T&&ac)){return aB.fail("No means of selecting a Range or TextRange was found"),!1}U.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode){e=ak.getDocument(this.anchorNode)}else{if("Control"==this.docSelection.type){var d=this.docSelection.createRange();d.length&&(e=ak.getDocument(d.item(0)).body.createTextRange())}}e&&(e.body.createTextRange().select(),this.docSelection.empty())}}catch(f){}ax(this)},U.addRange=function(b){"Control"==this.docSelection.type?ar(this,b):(ah.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,ay(this,b,!1))},U.setRanges=function(d){this.removeAllRanges();var c=d.length;c>1?ap(this,d):c&&this.addRange(d[0])}}U.getRangeAt=function(b){if(0>b||b>=this.rangeCount){throw new ag("INDEX_SIZE_ERR")}return this._ranges[b]};var Q;if(ac){Q=function(a){var d;aC.isSelectionValid(a.win)?d=a.docSelection.createRange():(d=ak.getBody(a.win.document).createTextRange(),d.collapse(!0)),"Control"==a.docSelection.type?at(a):d&&"undefined"!=typeof d.text?au(a,d):ax(a)}}else{if(aj.isHostMethod(ae,"getRangeAt")&&"number"==typeof ae.rangeCount){Q=function(a){if(T&&ad&&"Control"==a.docSelection.type){at(a)}else{if(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount){for(var f=0,e=a.rangeCount;e>f;++f){a._ranges[f]=new aC.WrappedRange(a.nativeSelection.getRangeAt(f))}ay(a,a._ranges[a.rangeCount-1],O(a.nativeSelection)),a.isCollapsed=al(a)}else{ax(a)}}}}else{if(!Z||"boolean"!=typeof ae.isCollapsed||"boolean"!=typeof ab.collapsed||!aC.features.implementsDomRange){return aB.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1}Q=function(d){var c;c=d.nativeSelection,c.anchorNode?(c=S(c,0),d._ranges=[c],d.rangeCount=1,c=d.nativeSelection,d.anchorNode=c.anchorNode,d.anchorOffset=c.anchorOffset,d.focusNode=c.focusNode,d.focusOffset=c.focusOffset,d.isCollapsed=al(d)):ax(d)}}}U.refresh=function(d){var c=d?this._ranges.slice(0):null;if(Q(this),d){if(d=c.length,d!=this._ranges.length){return !1}for(;d--;){if(!ai.rangesEqual(c[d],this._ranges[d])){return !1}}return !0}};var P=function(h,f){var l=h.getAllRanges(),k=!1;h.removeAllRanges();for(var j=0,i=l.length;i>j;++j){k||f!==l[j]?h.addRange(l[j]):k=!0}h.rangeCount||ax(h)};U.removeRange=T?function(i){if("Control"==this.docSelection.type){for(var h,n=this.docSelection.createRange(),i=av(i),m=ak.getDocument(n.item(0)),m=ak.getBody(m).createControlRange(),l=!1,k=0,j=n.length;j>k;++k){h=n.item(k),h!==i||l?m.add(n.item(k)):l=!0}m.select(),at(this)}else{P(this,i)}}:function(b){P(this,b)};var O;!ac&&Z&&aC.features.implementsDomRange?(O=function(d){var c=!1;return d.anchorNode&&(c=1==ak.comparePoints(d.anchorNode,d.anchorOffset,d.focusNode,d.focusOffset)),c},U.isBackwards=function(){return O(this)}):O=U.isBackwards=function(){return !1},U.toString=function(){for(var e=[],d=0,f=this.rangeCount;f>d;++d){e[d]=""+this._ranges[d]}return e.join("")},U.collapse=function(a,f){ao(this,a);var e=aC.createRange(ak.getDocument(a));e.collapseToPoint(a,f),this.removeAllRanges(),this.addRange(e),this.isCollapsed=!0},U.collapseToStart=function(){if(!this.rangeCount){throw new ag("INVALID_STATE_ERR")}var b=this._ranges[0];this.collapse(b.startContainer,b.startOffset)},U.collapseToEnd=function(){if(!this.rangeCount){throw new ag("INVALID_STATE_ERR")}var b=this._ranges[this.rangeCount-1];this.collapse(b.endContainer,b.endOffset)},U.selectAllChildren=function(a){ao(this,a);var d=aC.createRange(ak.getDocument(a));d.selectNodeContents(a),this.removeAllRanges(),this.addRange(d)},U.deleteFromDocument=function(){if(T&&ad&&"Control"==this.docSelection.type){for(var e,d=this.docSelection.createRange();d.length;){e=d.item(0),d.remove(e),e.parentNode.removeChild(e)}this.refresh()}else{if(this.rangeCount){d=this.getAllRanges(),this.removeAllRanges(),e=0;for(var f=d.length;f>e;++e){d[e].deleteContents()}this.addRange(d[f-1])}}},U.getAllRanges=function(){return this._ranges.slice(0)},U.setSingleRange=function(b){this.setRanges([b])},U.containsNode=function(f,e){for(var h=0,g=this._ranges.length;g>h;++h){if(this._ranges[h].containsNode(f,e)){return !0}}return !1},U.toHtml=function(){var e="";if(this.rangeCount){for(var e=ai.getRangeDocument(this._ranges[0]).createElement("div"),d=0,f=this._ranges.length;f>d;++d){e.appendChild(this._ranges[d].cloneContents())}e=e.innerHTML}return e},U.getName=function(){return"WrappedSelection"},U.inspect=function(){return an(this)},U.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null},aq.inspect=an,aC.Selection=aq,aC.selectionPrototype=U,aC.addCreateMissingNativeApiListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return aC.getSelection(this)}),a=null})});var Base=function(){};Base.extend=function(h,g){var l=Base.prototype.extend;Base._prototyping=!0;var k=new this;l.call(k,h),k.base=function(){},delete Base._prototyping;var j=k.constructor,i=k.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==i){this._constructing=!0,j.apply(this,arguments),delete this._constructing}else{if(null!=arguments[0]){return(arguments[0].extend||l).call(arguments[0],k)}}}};return i.ancestor=this,i.extend=this.extend,i.forEach=this.forEach,i.implement=this.implement,i.prototype=k,i.toString=this.toString,i.valueOf=function(b){return"object"==b?i:j.valueOf()},l.call(i,g),"function"==typeof i.init&&i.init(),i},Base.prototype={extend:function(r,q){if(1<arguments.length){var p=this[r];if(p&&"function"==typeof q&&(!p.valueOf||p.valueOf()!=q.valueOf())&&/\bbase\b/.test(q)){var o=q.valueOf(),q=function(){var d=this.base||Base.prototype.base;this.base=p;var c=o.apply(this,arguments);return this.base=d,c};q.valueOf=function(b){return"object"==b?q:o},q.toString=Base.toString}this[r]=q}else{if(r){var n=Base.prototype.extend;!Base._prototyping&&"function"!=typeof this&&(n=this.extend||n);for(var m={toSource:null},l=["constructor","toString","valueOf"],k=Base._prototyping?0:1;j=l[k++];){r[j]!=m[j]&&n.call(this,j,r[j])}for(var j in r){m[j]||n.call(this,j,r[j])}}}return this}},Base=Base.extend({constructor:function(b){this.extend(b)}},{ancestor:Object,version:"1.1",forEach:function(f,e,h){for(var g in f){void 0===this.prototype[g]&&e.call(h,f[g],g,f)}},implement:function(){for(var b=0;b<arguments.length;b++){"function"==typeof arguments[b]?arguments[b](this.prototype):this.prototype.extend(arguments[b])}return this},toString:function(){return""+this.valueOf()}}),wysihtml5.browser=function(){var i=navigator.userAgent,h=document.createElement("div"),n=-1!==i.indexOf("MSIE")&&-1===i.indexOf("Opera"),m=-1!==i.indexOf("Gecko")&&-1===i.indexOf("KHTML"),l=-1!==i.indexOf("AppleWebKit/"),k=-1!==i.indexOf("Chrome/"),j=-1!==i.indexOf("Opera/");return{USER_AGENT:i,supported:function(){var b=this.USER_AGENT.toLowerCase(),o="contentEditable" in h,g=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,f=document.querySelector&&document.querySelectorAll,b=this.isIos()&&5>(/ipad|iphone|ipod/.test(b)&&b.match(/ os (\d+).+? like mac os x/)||[,0])[1]||-1!==b.indexOf("opera mobi")||-1!==b.indexOf("hpwos/");return o&&g&&f&&!b},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){var b=this.USER_AGENT.toLowerCase();return -1!==b.indexOf("webkit")&&-1!==b.indexOf("mobile")},supportsSandboxedIframes:function(){return n},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return !("querySelector" in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return !m},hasCurrentStyleProperty:function(){return"currentStyle" in h},insertsLineBreaksOnReturn:function(){return m},supportsPlaceholderAttributeOn:function(b){return"placeholder" in b},supportsEvent:function(b){var d;return(d="on"+b in h)||(h.setAttribute("on"+b,"return;"),d="function"==typeof h["on"+b]),d},supportsEventsInIframeCorrectly:function(){return !j},firesOnDropOnlyWhenOnDragOverIsCancelled:function(){return l||m},supportsDataTransfer:function(){try{return l&&(window.Clipboard||window.DataTransfer).prototype.getData}catch(b){return !1}},supportsHTML5Tags:function(b){return b=b.createElement("div"),b.innerHTML="<article>foo</article>","<article>foo</article>"===b.innerHTML.toLowerCase()},supportsCommand:function(){var d={formatBlock:n,insertUnorderedList:n||j||l,insertOrderedList:n||j||l},c={insertHTML:m};return function(o,g){if(!d[g]){try{return o.queryCommandSupported(g)}catch(b){}try{return o.queryCommandEnabled(g)}catch(a){return !!c[g]}}return !1}}(),doesAutoLinkingInContentEditable:function(){return n},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return m||j||l},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return m||n||j},clearsListsInContentEditableCorrectly:function(){return m||n||l},autoScrollsToCaret:function(){return !l},autoClosesUnclosedTags:function(){var b,d=h.cloneNode(!1);return d.innerHTML="<p><div></div>",d=d.innerHTML.toLowerCase(),b="<p></p><div></div>"===d||"<p><div></div></p>"===d,this.autoClosesUnclosedTags=function(){return b},b},supportsNativeGetElementsByClassName:function(){return -1!==(""+document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection" in window&&"modify" in window.getSelection()},supportsClassList:function(){return"classList" in h},needsSpaceAfterLineBreak:function(){return j},supportsSpeechApiOn:function(a){return 11<=(i.match(/Chrome\/(\d+)/)||[,0])[1]&&("onwebkitspeechchange" in a||"speech" in a)},crashesWhenDefineProperty:function(b){return n&&("XMLHttpRequest"===b||"XDomainRequest"===b)},doesAsyncFocus:function(){return n},hasProblemsSettingCaretAfterImg:function(){return n},hasUndoInContextMenu:function(){return m||k||j}}}(),wysihtml5.lang.array=function(b){return{contains:function(a){if(b.indexOf){return -1!==b.indexOf(a)}for(var f=0,e=b.length;e>f;f++){if(b[f]===a){return !0}}return !1},without:function(a){for(var a=wysihtml5.lang.array(a),h=[],g=0,f=b.length;f>g;g++){a.contains(b[g])||h.push(b[g])}return h},get:function(){for(var a=0,f=b.length,e=[];f>a;a++){e.push(b[a])}return e}}},wysihtml5.lang.Dispatcher=Base.extend({observe:function(d,c){return this.events=this.events||{},this.events[d]=this.events[d]||[],this.events[d].push(c),this},on:function(){return this.observe.apply(this,wysihtml5.lang.array(arguments).get())},fire:function(f,e){this.events=this.events||{};for(var h=this.events[f]||[],g=0;g<h.length;g++){h[g].call(this,e)}return this},stopObserving:function(g,f){this.events=this.events||{};var j,i,h=0;if(g){for(j=this.events[g]||[],i=[];h<j.length;h++){j[h]!==f&&f&&i.push(j[h])}this.events[g]=i}else{this.events={}}return this}}),wysihtml5.lang.object=function(b){return{merge:function(a){for(var d in a){b[d]=a[d]}return this},get:function(){return b},clone:function(){var a,d={};for(a in b){d[a]=b[a]}return d},isArray:function(){return"[object Array]"===Object.prototype.toString.call(b)}}},function(){var d=/^\s+/,c=/\s+$/;wysihtml5.lang.string=function(a){return a=""+a,{trim:function(){return a.replace(d,"").replace(c,"")},interpolate:function(f){for(var e in f){a=this.replace("#{"+e+"}").by(f[e])}return a},replace:function(b){return{by:function(e){return a.split(b).join(e)}}}}}}(),function(j){function i(b){return b.replace(n,function(g,f){var r=(f.match(m)||[])[1]||"",q=k[r],f=f.replace(m,"");f.split(q).length>f.split(r).length&&(f+=r,r="");var h=q=f;return f.length>l&&(h=h.substr(0,l)+"..."),"www."===q.substr(0,4)&&(q="http://"+q),'<a href="'+q+'">'+h+"</a>"+r})}function p(d){if(!o.contains(d.nodeName)){if(d.nodeType!==j.TEXT_NODE||!d.data.match(n)){for(b=j.lang.array(d.childNodes).get(),c=b.length,a=0;c>a;a++){p(b[a])}return d}var c,b=d.parentNode;c=b.ownerDocument;var a=c._wysihtml5_tempElement;for(a||(a=c._wysihtml5_tempElement=c.createElement("div")),c=a,c.innerHTML="<span></span>"+i(d.data),c.removeChild(c.firstChild);c.firstChild;){b.insertBefore(c.firstChild,d)}b.removeChild(d)}}var o=j.lang.array("CODE PRE A SCRIPT HEAD TITLE STYLE".split(" ")),n=/((https?:\/\/|www\.)[^\s<]{3,})/gi,m=/([^\w\/\-](,?))$/i,l=100,k={")":"(","]":"[","}":"{"};j.dom.autoLink=function(d){var c;d:{c=d;for(var f;c.parentNode;){if(c=c.parentNode,f=c.nodeName,o.contains(f)){c=!0;break d}if("body"===f){break}}c=!1}return c?d:(d===d.ownerDocument.documentElement&&(d=d.ownerDocument.body),p(d))},j.dom.autoLink.URL_REG_EXP=n}(wysihtml5),function(e){var d=e.browser.supportsClassList(),f=e.dom;f.addClass=function(b,c){return d?b.classList.add(c):(f.hasClass(b,c)||(b.className+=" "+c),void 0)},f.removeClass=function(b,g){return d?b.classList.remove(g):(b.className=b.className.replace(RegExp("(^|\\s+)"+g+"(\\s+|$)")," "),void 0)},f.hasClass=function(b,h){if(d){return b.classList.contains(h)}var g=b.className;return 0<g.length&&(g==h||RegExp("(^|\\s)"+h+"(\\s|$)").test(g))}}(wysihtml5),wysihtml5.dom.contains=function(){var b=document.documentElement;return b.contains?function(d,c){return c.nodeType!==wysihtml5.ELEMENT_NODE&&(c=c.parentNode),d!==c&&d.contains(c)}:b.compareDocumentPosition?function(d,c){return !!(16&d.compareDocumentPosition(c))}:void 0}(),wysihtml5.dom.convertToList=function(){function b(e,d){var f=e.createElement("li");return d.appendChild(f),f}return function(v,u){if("UL"===v.nodeName||"OL"===v.nodeName||"MENU"===v.nodeName){return v}var t,s,r,q,p,o=v.ownerDocument,n=o.createElement(u),m=v.querySelectorAll("br"),a=m.length;for(p=0;a>p;p++){for(t=m[p];(s=t.parentNode)&&s!==v&&s.lastChild===t;){if("block"===wysihtml5.dom.getStyle("display").from(s)){s.removeChild(t);break}wysihtml5.dom.insert(t).after(t.parentNode)}}for(m=wysihtml5.lang.array(v.childNodes).get(),a=m.length,p=0;a>p;p++){q=q||b(o,n),t=m[p],s="block"===wysihtml5.dom.getStyle("display").from(t),r="BR"===t.nodeName,s?(q=q.firstChild?b(o,n):q,q.appendChild(t),q=null):r?q=q.firstChild?null:q:q.appendChild(t)}return v.parentNode.replaceChild(n,v),n}}(),wysihtml5.dom.copyAttributes=function(b){return{from:function(a){return{to:function(j){for(var i,h=0,g=b.length;g>h;h++){i=b[h],"undefined"!=typeof a[i]&&""!==a[i]&&(j[i]=a[i])}return{andTo:arguments.callee}}}}}},function(e){var d=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],f=function(h){var g;e:for(var b=0,a=d.length;a>b;b++){if("border-box"===e.getStyle(d[b]).from(h)){g=d[b];break e}}return g?parseInt(e.getStyle("width").from(h),10)<h.offsetWidth:!1};e.copyStyles=function(a){return{from:function(l){f(l)&&(a=wysihtml5.lang.array(a).without(d));for(var k,j="",c=a.length,b=0;c>b;b++){k=a[b],j+=k+":"+e.getStyle(k).from(l)+";"}return{to:function(g){return e.setStyles(j).on(g),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(b){b.dom.delegate=function(a,h,g,f){return b.dom.observe(a,g,function(i){for(var e=i.target,c=b.lang.array(a.querySelectorAll(h));e&&e!==a;){if(c.contains(e)){f.call(e,i);break}e=e.parentNode}})}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var b="abbr article aside audio bdi canvas command datalist details figcaption figure footer header hgroup keygen mark meter nav output progress rp rt ruby svg section source summary time track video wbr".split(" ");return function(a,l){var k,l=l||document;if("object"==typeof a&&a.nodeType){k=l.createElement("div"),k.appendChild(a)}else{if(wysihtml5.browser.supportsHTML5Tags(l)){k=l.createElement("div"),k.innerHTML=a}else{if(k=l,!k._wysihtml5_supportsHTML5Tags){for(var j=0,i=b.length;i>j;j++){k.createElement(b[j])}k._wysihtml5_supportsHTML5Tags=!0}k=l,j=k.createElement("div"),j.style.display="none",k.body.appendChild(j);try{j.innerHTML=a}catch(h){}k.body.removeChild(j),k=j}}return k}}(),wysihtml5.dom.getParentElement=function(){function b(d,c){return c&&c.length?"string"==typeof c?d===c:wysihtml5.lang.array(c).contains(d):!0}return function(a,n,m){if(m=m||50,n.className||n.classRegExp){b:{for(var l=n.nodeName,k=n.className,n=n.classRegExp;m--&&a&&"BODY"!==a.nodeName;){var j;if((j=a.nodeType===wysihtml5.ELEMENT_NODE)&&(j=b(a.nodeName,l))){j=k;var i=(a.className||"").match(n)||[];j=j?i[i.length-1]===j:!!i.length}if(j){break b}a=a.parentNode}a=null}return a}b:{for(l=n.nodeName,k=m;k--&&a&&"BODY"!==a.nodeName;){if(b(a.nodeName,l)){break b}a=a.parentNode}a=null}return a}}(),wysihtml5.dom.getStyle=function(){function e(b){return b.replace(f,function(c){return c.charAt(1).toUpperCase()})}var d={"float":"styleFloat" in document.createElement("div").style?"styleFloat":"cssFloat"},f=/\-[a-z]/g;return function(a){return{from:function(q){if(q.nodeType===wysihtml5.ELEMENT_NODE){var p=q.ownerDocument,o=d[a]||e(a),n=q.style,m=q.currentStyle,l=n[o];if(l){return l}if(m){try{return m[o]}catch(c){}}var b,o=p.defaultView||p.parentWindow,p=("height"===a||"width"===a)&&"TEXTAREA"===q.nodeName;if(o.getComputedStyle){return p&&(b=n.overflow,n.overflow="hidden"),q=o.getComputedStyle(q,null).getPropertyValue(a),p&&(n.overflow=b||""),q}}}}}}(),wysihtml5.dom.hasElementWithTagName=function(){var d={},c=1;return function(h,g){var b=(h._wysihtml5_identifier||(h._wysihtml5_identifier=c++))+":"+g,a=d[b];return a||(a=d[b]=h.getElementsByTagName(g)),0<a.length}}(),function(e){var d={},f=1;e.dom.hasElementWithClassName=function(h,c){if(!e.browser.supportsNativeGetElementsByClassName()){return !!h.querySelector("."+c)}var b=(h._wysihtml5_identifier||(h._wysihtml5_identifier=f++))+":"+c,a=d[b];return a||(a=d[b]=h.getElementsByClassName(c)),0<a.length}}(wysihtml5),wysihtml5.dom.insert=function(b){return{after:function(a){a.parentNode.insertBefore(b,a.nextSibling)},before:function(a){a.parentNode.insertBefore(b,a)},into:function(a){a.appendChild(b)}}},wysihtml5.dom.insertCSS=function(b){return b=b.join("\n"),{into:function(a){var f=a.head||a.getElementsByTagName("head")[0],e=a.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=b:e.appendChild(a.createTextNode(b)),f&&f.appendChild(e)}}},wysihtml5.dom.observe=function(i,h,n){for(var m,l,h="string"==typeof h?[h]:h,k=0,j=h.length;j>k;k++){l=h[k],i.addEventListener?i.addEventListener(l,n,!1):(m=function(a){"target" in a||(a.target=a.srcElement),a.preventDefault=a.preventDefault||function(){this.returnValue=!1},a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=!0},n.call(i,a)},i.attachEvent("on"+l,m))}return{stop:function(){for(var c,b=0,a=h.length;a>b;b++){c=h[b],i.removeEventListener?i.removeEventListener(c,n,!1):i.detachEvent("on"+c,m)}}}},wysihtml5.dom.parse=function(){function t(a,v){var u,j=a.childNodes,d=j.length;u=r[a.nodeType];var c=0;if(u=u&&u(a),!u){return null}for(c=0;d>c;c++){(newChild=t(j[c],v))&&u.appendChild(newChild)}return v&&1>=u.childNodes.length&&u.nodeName.toLowerCase()===q&&!u.attributes.length?u.firstChild:u}function s(g,f){var j,f=f.toLowerCase();if((j="IMG"==g.nodeName)&&(j="src"==f)){var i;try{i=g.complete&&!g.mozMatchesSelector(":-moz-broken")}catch(h){g.complete&&"complete"===g.readyState&&(i=!0)}j=!0===i}return j?g.src:m&&"outerHTML" in g?-1!=g.outerHTML.toLowerCase().indexOf(" "+f+"=")?g.getAttribute(f):null:g.getAttribute(f)}var r={1:function(A){var z,y,x=n.tags;if(y=A.nodeName.toLowerCase(),z=A.scopeName,A._wysihtml5){return null}if(A._wysihtml5=1,"wysihtml5-temp"===A.className){return null}if(z&&"HTML"!=z&&(y=z+":"+y),"outerHTML" in A&&!wysihtml5.browser.autoClosesUnclosedTags()&&"P"===A.nodeName&&"</p>"!==A.outerHTML.slice(-4).toLowerCase()&&(y="div"),y in x){if(z=x[y],!z||z.remove){return null}z="string"==typeof z?{rename_tag:z}:z}else{if(!A.firstChild){return null}z={rename_tag:q}}y=A.ownerDocument.createElement(z.rename_tag||y);var x={},w=z.set_class,v=z.add_class,j=z.set_attributes,i=z.check_attributes,g=n.classes,e=0,d=[];z=[];var b,D=[],C=[];if(j&&(x=wysihtml5.lang.object(j).clone()),i){for(b in i){(j=l[i[b]])&&(j=j(s(A,b)),"string"==typeof j&&(x[b]=j))}}if(w&&d.push(w),v){for(b in v){(j=k[v[b]])&&(w=j(s(A,b)),"string"==typeof w&&d.push(w))}}for(g["_wysihtml5-temp-placeholder"]=1,(C=A.getAttribute("class"))&&(d=d.concat(C.split(p))),v=d.length;v>e;e++){A=d[e],g[A]&&z.push(A)}for(g=z.length;g--;){A=z[g],wysihtml5.lang.array(D).contains(A)||D.unshift(A)}D.length&&(x["class"]=D.join(" "));for(b in x){try{y.setAttribute(b,x[b])}catch(B){}}return x.src&&("undefined"!=typeof x.width&&y.setAttribute("width",x.width),"undefined"!=typeof x.height&&y.setAttribute("height",x.height)),y},3:function(b){return b.ownerDocument.createTextNode(b.data)}},q="span",p=/\s+/,o={tags:{},classes:{}},n={},m=!wysihtml5.browser.supportsGetAttributeCorrectly(),l={url:function(){var b=/^https?:\/\//i;return function(a){return a&&a.match(b)?a.replace(b,function(c){return c.toLowerCase()}):null}}(),alt:function(){var b=/[^ a-z0-9_\-]/gi;return function(a){return a?a.replace(b,""):""}}(),numbers:function(){var b=/\D/g;return function(a){return(a=(a||"").replace(b,""))||null}}()},k={align_img:function(){var b={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(a){return b[(""+a).toLowerCase()]}}(),align_text:function(){var b={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(a){return b[(""+a).toLowerCase()]}}(),clear_br:function(){var b={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(a){return b[(""+a).toLowerCase()]}}(),size_font:function(){var b={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(a){return b[(""+a).charAt(0)]}}()};return function(a,j,i,g){wysihtml5.lang.object(n).merge(o).merge(j).get();for(var i=i||a.ownerDocument||document,j=i.createDocumentFragment(),f="string"==typeof a,a=f?wysihtml5.dom.getAsDom(a,i):a;a.firstChild;){i=a.firstChild,a.removeChild(i),(i=t(i,g))&&j.appendChild(i)}return a.innerHTML="",a.appendChild(j),f?wysihtml5.quirks.getCorrectInnerHTML(a):a}}(),wysihtml5.dom.removeEmptyTextNodes=function(f){for(var e=wysihtml5.lang.array(f.childNodes).get(),h=e.length,g=0;h>g;g++){f=e[g],f.nodeType===wysihtml5.TEXT_NODE&&""===f.data&&f.parentNode.removeChild(f)}},wysihtml5.dom.renameElement=function(f,e){for(var h,g=f.ownerDocument.createElement(e);h=f.firstChild;){g.appendChild(h)}return wysihtml5.dom.copyAttributes(["align","className"]).from(f).to(g),f.parentNode.replaceChild(g,f),g},wysihtml5.dom.replaceWithChildNodes=function(d){if(d.parentNode){if(d.firstChild){for(var c=d.ownerDocument.createDocumentFragment();d.firstChild;){c.appendChild(d.firstChild)}d.parentNode.replaceChild(c,d)}else{d.parentNode.removeChild(d)}}},function(d){function c(f){var e=f.ownerDocument.createElement("br");f.appendChild(e)}d.resolveList=function(l){if("MENU"===l.nodeName||"UL"===l.nodeName||"OL"===l.nodeName){var k,j,i,b=l.ownerDocument.createDocumentFragment(),a=l.previousElementSibling||l.previousSibling;for(a&&"block"!==d.getStyle("display").from(a)&&c(b);i=l.firstChild;){for(k=i.lastChild;a=i.firstChild;){j=(j=a===k)&&"block"!==d.getStyle("display").from(a)&&"BR"!==a.nodeName,b.appendChild(a),j&&c(b)}i.parentNode.removeChild(i)}l.parentNode.replaceChild(b,l)}}}(wysihtml5.dom),function(g){var f=document,j="parent top opener frameElement frames localStorage globalStorage sessionStorage indexedDB".split(" "),i="open close openDialog showModalDialog alert confirm prompt openDatabase postMessage XMLHttpRequest XDomainRequest".split(" "),h=["referrer","write","open","close"];g.dom.Sandbox=Base.extend({constructor:function(a,d){this.callback=a||g.EMPTY_FUNCTION,this.config=g.lang.object({}).merge(d).get(),this.iframe=this._createIframe()},insertInto:function(b){"string"==typeof b&&(b=f.getElementById(b)),b.appendChild(this.iframe)},getIframe:function(){return this.iframe},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var b=this.getIframe();b.parentNode.removeChild(b)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var b=this,a=f.createElement("iframe");return a.className="wysihtml5-sandbox",g.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(a),g.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(a.src="javascript:'<html></html>'"),a.onload=function(){a.onreadystatechange=a.onload=null,b._onLoadIframe(a)},a.onreadystatechange=function(){/loaded|complete/.test(a.readyState)&&(a.onreadystatechange=a.onload=null,b._onLoadIframe(a))},a},_onLoadIframe:function(l){if(g.dom.contains(f.documentElement,l)){var e=this,d=l.contentWindow,c=l.contentWindow.document,b=this._getHtml({charset:f.characterSet||f.charset||"utf-8",stylesheets:this.config.stylesheets});if(c.open("text/html","replace"),c.write(b),c.close(),this.getWindow=function(){return l.contentWindow},this.getDocument=function(){return l.contentWindow.document},d.onerror=function(m,k,n){throw Error("wysihtml5.Sandbox: "+m,k,n)},!g.browser.supportsSandboxedIframes()){var a,b=0;for(a=j.length;a>b;b++){this._unset(d,j[b])}for(b=0,a=i.length;a>b;b++){this._unset(d,i[b],g.EMPTY_FUNCTION)}for(b=0,a=h.length;a>b;b++){this._unset(c,h[b])}this._unset(c,"cookie","",!0)}this.loaded=!0,setTimeout(function(){e.callback(e)},0)}},_getHtml:function(a){var n,m=a.stylesheets,l="",k=0;if(m="string"==typeof m?[m]:m){for(n=m.length;n>k;k++){l+='<link rel="stylesheet" href="'+m[k]+'">'}}return a.stylesheets=l,g.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(a)},_unset:function(r,q,p,o){try{r[q]=p}catch(n){}try{r.__defineGetter__(q,function(){return p})}catch(m){}if(o){try{r.__defineSetter__(q,function(){})}catch(l){}}if(!g.browser.crashesWhenDefineProperty(q)){try{var k={get:function(){return p}};o&&(k.set=function(){}),Object.defineProperty(r,q,k)}catch(a){}}}})}(wysihtml5),function(){var b={className:"class"};wysihtml5.dom.setAttributes=function(a){return{on:function(f){for(var e in a){f.setAttribute(b[e]||e,a[e])}}}}}(),wysihtml5.dom.setStyles=function(b){return{on:function(a){if(a=a.style,"string"==typeof b){a.cssText+=";"+b}else{for(var d in b){"float"===d?(a.cssFloat=b[d],a.styleFloat=b[d]):a[d]=b[d]}}}}},function(b){b.simulatePlaceholder=function(a,j,i){var h=function(){j.hasPlaceholderSet()&&j.clear(),b.removeClass(j.element,"placeholder")},g=function(){j.isEmpty()&&(j.setValue(i),b.addClass(j.element,"placeholder"))};a.observe("set_placeholder",g).observe("unset_placeholder",h).observe("focus:composer",h).observe("paste:composer",h).observe("blur:composer",g),g()}}(wysihtml5.dom),function(d){var c=document.documentElement;"textContent" in c?(d.setTextContent=function(f,e){f.textContent=e},d.getTextContent=function(b){return b.textContent}):"innerText" in c?(d.setTextContent=function(f,e){f.innerText=e},d.getTextContent=function(b){return b.innerText}):(d.setTextContent=function(f,e){f.nodeValue=e},d.getTextContent=function(b){return b.nodeValue})}(wysihtml5.dom),wysihtml5.quirks.cleanPastedHTML=function(){var b={"a u":wysihtml5.dom.replaceWithChildNodes};return function(a,p,o){var n,m,l,p=p||b,o=o||a.ownerDocument||document,k="string"==typeof a,j=0,a=k?wysihtml5.dom.getAsDom(a,o):a;for(l in p){for(n=a.querySelectorAll(l),o=p[l],m=n.length;m>j;j++){o(n[j])}}return k?a.innerHTML:a}}(),function(d){var c=d.dom;d.quirks.ensureProperClearing=function(){var b=function(){var e=this;setTimeout(function(){var a=e.innerHTML.toLowerCase();("<p>&nbsp;</p>"==a||"<p>&nbsp;</p><p>&nbsp;</p>"==a)&&(e.innerHTML="")},0)};return function(a){c.observe(a.element,["cut","keydown"],b)}}(),d.quirks.ensureProperClearingOfLists=function(){var a=["OL","UL","MENU"];return function(b){c.observe(b.element,"keydown",function(h){if(h.keyCode===d.BACKSPACE_KEY){var g=b.selection.getSelectedNode(),h=b.element;h.firstChild&&d.lang.array(a).contains(h.firstChild.nodeName)&&(g=c.getParentElement(g,{nodeName:a}))&&g==h.firstChild&&1>=g.childNodes.length&&(g.firstChild?""===g.firstChild.innerHTML:1)&&g.parentNode.removeChild(g)}})}}()}(wysihtml5),function(b){b.quirks.getCorrectInnerHTML=function(a){var l=a.innerHTML;if(-1===l.indexOf("%7E")){return l}var k,j,i,h,a=a.querySelectorAll("[href*='~'], [src*='~']");for(h=0,i=a.length;i>h;h++){k=a[h].href||a[h].src,j=b.lang.string(k).replace("~").by("%7E"),l=b.lang.string(l).replace(j).by(k)}return l}}(wysihtml5),function(f){var e=f.dom,h="LI P H1 H2 H3 H4 H5 H6".split(" "),g=["UL","OL","MENU"];f.quirks.insertLineBreakOnReturn=function(b){function a(j){if(j=e.getParentElement(j,{nodeName:["P","DIV"]},2)){var i=document.createTextNode(f.INVISIBLE_SPACE);e.insert(i).before(j),e.replaceWithChildNodes(j),b.selection.selectNode(i)}}e.observe(b.element.ownerDocument,"keydown",function(j){var d=j.keyCode;if(!(j.shiftKey||d!==f.ENTER_KEY&&d!==f.BACKSPACE_KEY)){var c=b.selection.getSelectedNode();(c=e.getParentElement(c,{nodeName:h},4))?"LI"!==c.nodeName||d!==f.ENTER_KEY&&d!==f.BACKSPACE_KEY?c.nodeName.match(/H[1-6]/)&&d===f.ENTER_KEY&&setTimeout(function(){a(b.selection.getSelectedNode())},0):setTimeout(function(){var i,k=b.selection.getSelectedNode();k&&((i=e.getParentElement(k,{nodeName:g},2))||a(k))},0):d===f.ENTER_KEY&&!f.browser.insertsLineBreaksOnReturn()&&(b.commands.exec("insertLineBreak"),j.preventDefault())}})}}(wysihtml5),function(b){b.quirks.redraw=function(a){b.dom.addClass(a,"wysihtml5-quirks-redraw"),b.dom.removeClass(a,"wysihtml5-quirks-redraw");try{var f=a.ownerDocument;f.execCommand("italic",!1,null),f.execCommand("italic",!1,null)}catch(e){}}}(wysihtml5),function(d){var c=d.dom;d.Selection=Base.extend({constructor:function(b){window.rangy.init(),this.editor=b,this.composer=b.composer,this.doc=this.composer.doc},getBookmark:function(){var b=this.getRange();return b&&b.cloneRange()},setBookmark:function(b){b&&this.setSelection(b)},setBefore:function(f){var e=rangy.createRange(this.doc);return e.setStartBefore(f),e.setEndBefore(f),this.setSelection(e)},setAfter:function(f){var e=rangy.createRange(this.doc);return e.setStartAfter(f),e.setEndAfter(f),this.setSelection(e)},selectNode:function(n){var m=rangy.createRange(this.doc),l=n.nodeType===d.ELEMENT_NODE,k="canHaveHTML" in n?n.canHaveHTML:"IMG"!==n.nodeName,j=l?n.innerHTML:n.data,j=""===j||j===d.INVISIBLE_SPACE,b=c.getStyle("display").from(n),b="block"===b||"list-item"===b;if(j&&l&&k){try{n.innerHTML=d.INVISIBLE_SPACE}catch(a){}}k?m.selectNodeContents(n):m.selectNode(n),k&&j&&l?m.collapse(b):k&&j&&(m.setStartAfter(n),m.setEndAfter(n)),this.setSelection(m)},getSelectedNode:function(b){return b&&this.doc.selection&&"Control"===this.doc.selection.type&&(b=this.doc.selection.createRange())&&b.length?b.item(0):(b=this.getSelection(this.doc),b.focusNode===b.anchorNode?b.focusNode:(b=this.getRange(this.doc))?b.commonAncestorContainer:this.doc.body)},executeAndRestore:function(r,q){var p=this.doc.body,o=q&&p.scrollTop,n=q&&p.scrollLeft,m='<span class="_wysihtml5-temp-placeholder">'+d.INVISIBLE_SPACE+"</span>",l=this.getRange(this.doc);if(l){m=l.createContextualFragment(m),l.insertNode(m);try{r(l.startContainer,l.endContainer)}catch(k){setTimeout(function(){throw k},0)}(caretPlaceholder=this.doc.querySelector("._wysihtml5-temp-placeholder"))?(l=rangy.createRange(this.doc),l.selectNode(caretPlaceholder),l.deleteContents(),this.setSelection(l)):p.focus(),q&&(p.scrollTop=o,p.scrollLeft=n);try{caretPlaceholder.parentNode.removeChild(caretPlaceholder)}catch(a){}}else{r(p,p)}},executeAndRestoreSimple:function(t){var s,r,q,p=this.getRange(),o=this.doc.body;if(p){s=p.getNodes([3]),o=s[0]||p.startContainer,q=s[s.length-1]||p.endContainer,s=o===p.startContainer?p.startOffset:0,r=q===p.endContainer?p.endOffset:q.length;try{t(p.startContainer,p.endContainer)}catch(n){setTimeout(function(){throw n},0)}t=rangy.createRange(this.doc);try{t.setStart(o,s)}catch(m){}try{t.setEnd(q,r)}catch(l){}try{this.setSelection(t)}catch(k){}}else{t(o,o)}},insertHTML:function(f){var f=rangy.createRange(this.doc).createContextualFragment(f),e=f.lastChild;this.insertNode(f),e&&this.setAfter(e)},insertNode:function(f){var e=this.getRange();e&&e.insertNode(f)},surround:function(f){var e=this.getRange();if(e){try{e.surroundContents(f),this.selectNode(f)}catch(g){f.appendChild(e.extractContents()),e.insertNode(f)}}},scrollIntoView:function(){var a,h=this.doc,g=h.documentElement.scrollHeight>h.documentElement.offsetHeight;if((a=h._wysihtml5ScrollIntoViewElement)||(a=h.createElement("span"),a.innerHTML=d.INVISIBLE_SPACE),a=h._wysihtml5ScrollIntoViewElement=a,g){this.insertNode(a);var g=a,f=0;if(g.parentNode){do{f+=g.offsetTop||0,g=g.offsetParent}while(g)}g=f,a.parentNode.removeChild(a),g>h.body.scrollTop&&(h.body.scrollTop=g)}},selectLine:function(){d.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var b=this.doc.defaultView.getSelection();b.modify("extend","left","lineboundary"),b.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var h,g=this.doc.selection.createRange(),l=g.boundingTop,k=this.doc.body.scrollWidth;if(g.moveToPoint){for(0===l&&(h=this.doc.createElement("span"),this.insertNode(h),l=h.offsetTop,h.parentNode.removeChild(h)),l+=1,h=-10;k>h;h+=2){try{g.moveToPoint(h,l);break}catch(j){}}for(h=this.doc.selection.createRange();k>=0;k--){try{h.moveToPoint(k,l);break}catch(i){}}g.setEndPoint("EndToEnd",h),g.select()}},getText:function(){var b=this.getSelection();return b?b.toString():""},getNodes:function(f,e){var g=this.getRange();return g?g.getNodes([f],e):[]},getRange:function(){var b=this.getSelection();return b&&b.rangeCount&&b.getRangeAt(0)},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(b){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow).setSingleRange(b)}})}(wysihtml5),function(j,i){function p(b,d){return i.dom.isCharacterDataNode(b)?0==d?!!b.previousSibling:d==b.length?!!b.nextSibling:!0:d>0&&d<b.childNodes.length}function o(b,r,q){var h;if(i.dom.isCharacterDataNode(r)&&(0==q?(q=i.dom.getNodeIndex(r),r=r.parentNode):q==r.length?(q=i.dom.getNodeIndex(r)+1,r=r.parentNode):h=i.dom.splitDataNode(r,q)),!h){h=r.cloneNode(!1),h.id&&h.removeAttribute("id");for(var d;d=r.childNodes[q];){h.appendChild(d)}i.dom.insertAfter(h,r)}return r==b?h:o(b,h.parentNode,i.dom.getNodeIndex(h))}function n(a){this.firstTextNode=(this.isElementMerge=a.nodeType==j.ELEMENT_NODE)?a.lastChild:a,this.textNodes=[this.firstTextNode]}function m(f,e,h,g){this.tagNames=f||[l],this.cssClass=e||"",this.similarClassRegExp=h,this.normalize=g,this.applyToAnyTagName=!1}var l="span",k=/\s+/g;n.prototype={doMerge:function(){for(var g,f,r=[],q=0,h=this.textNodes.length;h>q;++q){g=this.textNodes[q],f=g.parentNode,r[q]=g.data,q&&(f.removeChild(g),f.hasChildNodes()||f.parentNode.removeChild(f))}return this.firstTextNode.data=r=r.join("")},getLength:function(){for(var d=this.textNodes.length,c=0;d--;){c+=this.textNodes[d].length}return c},toString:function(){for(var e=[],d=0,f=this.textNodes.length;f>d;++d){e[d]="'"+this.textNodes[d].data+"'"}return"[Merge("+e.join(",")+")]"}},m.prototype={getAncestorWithClass:function(f){for(var b;f;){if(this.cssClass){if(b=this.cssClass,f.className){var a=f.className.match(this.similarClassRegExp)||[];b=a[a.length-1]===b}else{b=!1}}else{b=!0}if(f.nodeType==j.ELEMENT_NODE&&i.dom.arrayContains(this.tagNames,f.tagName.toLowerCase())&&b){return f}f=f.parentNode}return !1},postApply:function(C,B){for(var A,z,y,x=C[0],w=C[C.length-1],v=[],u=x,t=w,s=0,r=w.length,q=0,e=C.length;e>q;++q){z=C[q],(y=this.getAdjacentMergeableTextNode(z.parentNode,!1))?(A||(A=new n(y),v.push(A)),A.textNodes.push(z),z===x&&(u=A.firstTextNode,s=u.length),z===w&&(t=A.firstTextNode,r=A.getLength())):A=null}if((x=this.getAdjacentMergeableTextNode(w.parentNode,!0))&&(A||(A=new n(w),v.push(A)),A.textNodes.push(x)),v.length){for(q=0,e=v.length;e>q;++q){v[q].doMerge()}B.setStart(u,s),B.setEnd(t,r)}},getAdjacentMergeableTextNode:function(a,r){var q=a.nodeType==j.TEXT_NODE,h=q?a.parentNode:a,g=r?"nextSibling":"previousSibling";if(q){if((q=a[g])&&q.nodeType==j.TEXT_NODE){return q}}else{if((q=h[g])&&this.areElementsMergeable(a,q)){return q[r?"firstChild":"lastChild"]}}return null},areElementsMergeable:function(b,t){var s;if((s=i.dom.arrayContains(this.tagNames,(b.tagName||"").toLowerCase()))&&(s=i.dom.arrayContains(this.tagNames,(t.tagName||"").toLowerCase()))&&(s=b.className.replace(k," ")==t.className.replace(k," "))){b:if(b.attributes.length!=t.attributes.length){s=!1}else{s=0;for(var r,q,h=b.attributes.length;h>s;++s){if(r=b.attributes[s],q=r.name,"class"!=q&&(q=t.attributes.getNamedItem(q),r.specified!=q.specified||r.specified&&r.nodeValue!==q.nodeValue)){s=!1;break b}}s=!0}}return s},createContainer:function(b){return b=b.createElement(this.tagNames[0]),this.cssClass&&(b.className=this.cssClass),b},applyToTextNode:function(b){var d=b.parentNode;1==d.childNodes.length&&i.dom.arrayContains(this.tagNames,d.tagName.toLowerCase())?this.cssClass&&(b=this.cssClass,d.className?(d.className&&(d.className=d.className.replace(this.similarClassRegExp,"")),d.className+=" "+b):d.className=b):(d=this.createContainer(i.dom.getDocument(b)),b.parentNode.insertBefore(d,b),d.appendChild(b))},isRemovable:function(a){return i.dom.arrayContains(this.tagNames,a.tagName.toLowerCase())&&j.lang.string(a.className).trim()==this.cssClass},undoToTextNode:function(d,c,f){if(c.containsNode(f)||(d=c.cloneRange(),d.selectNode(f),d.isPointInRange(c.endContainer,c.endOffset)&&p(c.endContainer,c.endOffset)&&(o(f,c.endContainer,c.endOffset),c.setEndAfter(f)),d.isPointInRange(c.startContainer,c.startOffset)&&p(c.startContainer,c.startOffset)&&(f=o(f,c.startContainer,c.startOffset))),this.similarClassRegExp&&f.className&&(f.className=f.className.replace(this.similarClassRegExp,"")),this.isRemovable(f)){for(c=f,f=c.parentNode;c.firstChild;){f.insertBefore(c.firstChild,c)}f.removeChild(c)}},applyToRange:function(a){var t=a.getNodes([j.TEXT_NODE]);if(!t.length){try{var s=this.createContainer(a.endContainer.ownerDocument);return a.surroundContents(s),this.selectNode(a,s),void 0}catch(r){}}if(a.splitBoundaries(),t=a.getNodes([j.TEXT_NODE]),t.length){for(var q=0,h=t.length;h>q;++q){s=t[q],this.getAncestorWithClass(s)||this.applyToTextNode(s)}a.setStart(t[0],0),s=t[t.length-1],a.setEnd(s,s.length),this.normalize&&this.postApply(t,a)}},undoToRange:function(a){var t,s,r=a.getNodes([j.TEXT_NODE]);r.length?(a.splitBoundaries(),r=a.getNodes([j.TEXT_NODE])):(r=a.endContainer.ownerDocument.createTextNode(j.INVISIBLE_SPACE),a.insertNode(r),a.selectNode(r),r=[r]);for(var q=0,h=r.length;h>q;++q){t=r[q],(s=this.getAncestorWithClass(t))&&this.undoToTextNode(t,a,s)}1==h?this.selectNode(a,r[0]):(a.setStart(r[0],0),t=r[r.length-1],a.setEnd(t,t.length),this.normalize&&this.postApply(r,a))},selectNode:function(a,t){var s=t.nodeType===j.ELEMENT_NODE,r="canHaveHTML" in t?t.canHaveHTML:!0,q=s?t.innerHTML:t.data;if((q=""===q||q===j.INVISIBLE_SPACE)&&s&&r){try{t.innerHTML=j.INVISIBLE_SPACE}catch(h){}}a.selectNodeContents(t),q&&s?a.collapse(!1):q&&(a.setStartAfter(t),a.setEndAfter(t))},getTextSelectedByRange:function(f,e){var h=e.cloneRange();h.selectNodeContents(f);var g=h.intersection(e),g=g?g.toString():"";return h.detach(),g},isAppliedToRange:function(a){var v,u=[],t=a.getNodes([j.TEXT_NODE]);if(!t.length){return(v=this.getAncestorWithClass(a.startContainer))?[v]:!1}for(var s,r=0,q=t.length;q>r;++r){if(s=this.getTextSelectedByRange(t[r],a),v=this.getAncestorWithClass(t[r]),""!=s&&!v){return !1}u.push(v)}return u},toggleRange:function(b){this.isAppliedToRange(b)?this.undoToRange(b):this.applyToRange(b)}},j.selection.HTMLApplier=m}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(b){this.editor=b,this.composer=b.composer,this.doc=this.composer.doc},support:function(b){return wysihtml5.browser.supportsCommand(this.doc,b)},exec:function(i,h){var n=wysihtml5.commands[i],m=wysihtml5.lang.array(arguments).get(),l=n&&n.exec,k=null;if(this.editor.fire("beforecommand:composer"),l){m.unshift(this.composer),k=l.apply(n,m)}else{try{k=this.doc.execCommand(i,!1,h)}catch(j){}}return this.editor.fire("aftercommand:composer"),k},state:function(g){var f=wysihtml5.commands[g],j=wysihtml5.lang.array(arguments).get(),i=f&&f.state;if(i){return j.unshift(this.composer),i.apply(f,j)}try{return this.doc.queryCommandState(g)}catch(h){return !1}},value:function(f){var e=wysihtml5.commands[f],h=e&&e.value;if(h){return h.call(e,this.composer,f)}try{return this.doc.queryCommandValue(f)}catch(g){return null}}}),function(b){b.commands.bold={exec:function(a,d){return b.commands.formatInline.exec(a,d,"b")},state:function(a,d){return b.commands.formatInline.state(a,d,"b")},value:function(){}}}(wysihtml5),function(g){function f(a,p){var o,n,m,e=a.doc,d="_wysihtml5-temp-"+ +new Date,c=0;for(g.commands.formatInline.exec(a,j,i,d,/non-matching-class/g),o=e.querySelectorAll(i+"."+d),d=o.length;d>c;c++){for(m in n=o[c],n.removeAttribute("class"),p){n.setAttribute(m,p[m])}}c=n,1===d&&(m=h.getTextContent(n),d=!!n.querySelector("*"),m=""===m||m===g.INVISIBLE_SPACE,!d&&m&&(h.setTextContent(n,p.text||n.href),e=e.createTextNode(" "),a.selection.setAfter(n),a.selection.insertNode(e),c=e)),a.selection.setAfter(c)}var j,i="A",h=g.dom;g.commands.createLink={exec:function(b,l,k){var e=this.state(b,l);e?b.selection.executeAndRestore(function(){for(var n,m,q,p=e.length,o=0;p>o;o++){n=e[o],m=h.getParentElement(n,{nodeName:"code"}),q=h.getTextContent(n),q.match(h.autoLink.URL_REG_EXP)&&!m?h.renameElement(n,"code"):h.replaceWithChildNodes(n)}}):(k="object"==typeof k?k:{href:k},f(b,k))},state:function(a,d){return g.commands.formatInline.state(a,d,"A")},value:function(){return j}}}(wysihtml5),function(d){var c=/wysiwyg-font-size-[a-z\-]+/g;d.commands.fontSize={exec:function(f,b,a){return d.commands.formatInline.exec(f,b,"span","wysiwyg-font-size-"+a,c)},state:function(f,b,a){return d.commands.formatInline.state(f,b,"span","wysiwyg-font-size-"+a,c)},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-color-[a-z]+/g;d.commands.foreColor={exec:function(f,b,a){return d.commands.formatInline.exec(f,b,"span","wysiwyg-color-"+a,c)},state:function(f,b,a){return d.commands.formatInline.state(f,b,"span","wysiwyg-color-"+a,c)},value:function(){}}}(wysihtml5),function(j){function i(a){for(a=a.previousSibling;a&&a.nodeType===j.TEXT_NODE&&!j.lang.string(a.data).trim();){a=a.previousSibling}return a}function p(a){for(a=a.nextSibling;a&&a.nodeType===j.TEXT_NODE&&!j.lang.string(a.data).trim();){a=a.nextSibling}return a}function o(b){return"BR"===b.nodeName||"block"===l.getStyle("display").from(b)?!0:!1}function n(a,r,q,h){if(h){var g=l.observe(a,"DOMNodeInserted",function(d){var e,d=d.target;d.nodeType===j.ELEMENT_NODE&&(e=l.getStyle("display").from(d),"inline"!==e.substr(0,6)&&(d.className+=" "+h))})}a.execCommand(r,!1,q),g&&g.stop()}function m(b,h){b.selection.selectLine(),b.selection.surround(h);var g=p(h),c=i(h);g&&"BR"===g.nodeName&&g.parentNode.removeChild(g),c&&"BR"===c.nodeName&&c.parentNode.removeChild(c),(g=h.lastChild)&&"BR"===g.nodeName&&g.parentNode.removeChild(g),b.selection.selectNode(h)}var l=j.dom,k="H1 H2 H3 H4 H5 H6 P BLOCKQUOTE DIV".split(" ");j.commands.formatBlock={exec:function(e,d,c,b,a){var h,g=e.doc,f=this.state(e,d,c,b,a),c="string"==typeof c?c.toUpperCase():c;if(f){e.selection.executeAndRestoreSimple(function(){a&&(f.className=f.className.replace(a,""));var t=!!j.lang.string(f.className).trim();if(t||f.nodeName!==(c||"DIV")){t&&l.renameElement(f,"DIV")}else{var t=f,s=t.ownerDocument,r=p(t),q=i(t);r&&!o(r)&&t.parentNode.insertBefore(s.createElement("br"),r),q&&!o(q)&&t.parentNode.insertBefore(s.createElement("br"),t),l.replaceWithChildNodes(f)}})}else{if((null===c||j.lang.array(k).contains(c))&&(h=e.selection.getSelectedNode(),f=l.getParentElement(h,{nodeName:k}))){return e.selection.executeAndRestoreSimple(function(){if(c&&(f=l.renameElement(f,c)),b){var q=f;q.className?(q.className=q.className.replace(a,""),q.className+=" "+b):q.className=b}}),void 0}e.commands.support(d)?n(g,d,c||"DIV",b):(f=g.createElement(c||"DIV"),b&&(f.className=b),m(e,f))}},state:function(g,f,r,q,h){return r="string"==typeof r?r.toUpperCase():r,g=g.selection.getSelectedNode(),l.getParentElement(g,{nodeName:r,className:q,classRegExp:h})},value:function(){}}}(wysihtml5),function(f){function e(a,n,m){var l=a+":"+n;if(!g[l]){var k=g,d=f.selection.HTMLApplier,c=h[a],a=c?[a.toLowerCase(),c.toLowerCase()]:[a.toLowerCase()];k[l]=new d(a,n,m,!0)}return g[l]}var h={strong:"b",em:"i",b:"strong",i:"em"},g={};f.commands.formatInline={exec:function(b,l,k,j,i){return(l=b.selection.getRange())?(e(k,j,i).toggleRange(l),b.selection.setSelection(l),void 0):!1},state:function(l,k,j,c,b){var k=l.doc,a=h[j]||j;return !f.dom.hasElementWithTagName(k,j)&&!f.dom.hasElementWithTagName(k,a)||c&&!f.dom.hasElementWithClassName(k,c)?!1:(l=l.selection.getRange(),l?e(j,c,b).isAppliedToRange(l):!1)},value:function(){}}}(wysihtml5),function(b){b.commands.insertHTML={exec:function(e,d,f){e.commands.support(d)?e.doc.execCommand(d,!1,f):e.selection.insertHTML(f)},state:function(){return !1},value:function(){}}}(wysihtml5),function(b){b.commands.insertImage={exec:function(a,j,i){var h,i="object"==typeof i?i:{src:i},g=a.doc,j=this.state(a);if(j){a.selection.setBefore(j),i=j.parentNode,i.removeChild(j),b.dom.removeEmptyTextNodes(i),"A"===i.nodeName&&!i.firstChild&&(a.selection.setAfter(i),i.parentNode.removeChild(i)),b.quirks.redraw(a.element)}else{j=g.createElement("IMG");for(h in i){j[h]=i[h]}a.selection.insertNode(j),b.browser.hasProblemsSettingCaretAfterImg()?(i=g.createTextNode(b.INVISIBLE_SPACE),a.selection.insertNode(i),a.selection.setAfter(i)):a.selection.setAfter(j)}},state:function(a){var d;return b.dom.hasElementWithTagName(a.doc,"IMG")?(d=a.selection.getSelectedNode())?"IMG"===d.nodeName?d:d.nodeType!==b.ELEMENT_NODE?!1:(d=a.selection.getText(),(d=b.lang.string(d).trim())?!1:(a=a.selection.getNodes(b.ELEMENT_NODE,function(c){return"IMG"===c.nodeName}),1!==a.length?!1:a[0])):!1:!1},value:function(c){return(c=this.state(c))&&c.src}}}(wysihtml5),function(d){var c="<br>"+(d.browser.needsSpaceAfterLineBreak()?" ":"");d.commands.insertLineBreak={exec:function(b,a){b.commands.support(a)?(b.doc.execCommand(a,!1,null),d.browser.autoScrollsToCaret()||b.selection.scrollIntoView()):b.commands.exec("insertHTML",c)},state:function(){return !1},value:function(){}}}(wysihtml5),function(b){b.commands.insertOrderedList={exec:function(a,n){var m,l=a.doc,k=a.selection.getSelectedNode(),j=b.dom.getParentElement(k,{nodeName:"OL"}),i=b.dom.getParentElement(k,{nodeName:"UL"}),k="_wysihtml5-temp-"+(new Date).getTime();a.commands.support(n)?l.execCommand(n,!1,null):j?a.selection.executeAndRestoreSimple(function(){b.dom.resolveList(j)}):i?a.selection.executeAndRestoreSimple(function(){b.dom.renameElement(i,"ol")}):(a.commands.exec("formatBlock","div",k),m=l.querySelector("."+k),l=""===m.innerHTML||m.innerHTML===b.INVISIBLE_SPACE,a.selection.executeAndRestoreSimple(function(){j=b.dom.convertToList(m,"ol")}),l&&a.selection.selectNode(j.querySelector("li")))},state:function(a){return a=a.selection.getSelectedNode(),b.dom.getParentElement(a,{nodeName:"OL"})},value:function(){}}}(wysihtml5),function(b){b.commands.insertUnorderedList={exec:function(a,n){var m,l=a.doc,k=a.selection.getSelectedNode(),j=b.dom.getParentElement(k,{nodeName:"UL"}),i=b.dom.getParentElement(k,{nodeName:"OL"}),k="_wysihtml5-temp-"+(new Date).getTime();a.commands.support(n)?l.execCommand(n,!1,null):j?a.selection.executeAndRestoreSimple(function(){b.dom.resolveList(j)}):i?a.selection.executeAndRestoreSimple(function(){b.dom.renameElement(i,"ul")}):(a.commands.exec("formatBlock","div",k),m=l.querySelector("."+k),l=""===m.innerHTML||m.innerHTML===b.INVISIBLE_SPACE,a.selection.executeAndRestoreSimple(function(){j=b.dom.convertToList(m,"ul")}),l&&a.selection.selectNode(j.querySelector("li")))},state:function(a){return a=a.selection.getSelectedNode(),b.dom.getParentElement(a,{nodeName:"UL"})},value:function(){}}}(wysihtml5),function(b){b.commands.italic={exec:function(a,d){return b.commands.formatInline.exec(a,d,"i")},state:function(a,d){return b.commands.formatInline.state(a,d,"i")},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyCenter={exec:function(a){return d.commands.formatBlock.exec(a,"formatBlock",null,"wysiwyg-text-align-center",c)},state:function(a){return d.commands.formatBlock.state(a,"formatBlock",null,"wysiwyg-text-align-center",c)},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyLeft={exec:function(a){return d.commands.formatBlock.exec(a,"formatBlock",null,"wysiwyg-text-align-left",c)},state:function(a){return d.commands.formatBlock.state(a,"formatBlock",null,"wysiwyg-text-align-left",c)},value:function(){}}}(wysihtml5),function(d){var c=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyRight={exec:function(a){return d.commands.formatBlock.exec(a,"formatBlock",null,"wysiwyg-text-align-right",c)},state:function(a){return d.commands.formatBlock.state(a,"formatBlock",null,"wysiwyg-text-align-right",c)},value:function(){}}}(wysihtml5),function(b){b.commands.underline={exec:function(a,d){return b.commands.formatInline.exec(a,d,"u")},state:function(a,d){return b.commands.formatInline.state(a,d,"u")},value:function(){}}}(wysihtml5),function(f){var e='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+f.INVISIBLE_SPACE+"</span>",h='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+f.INVISIBLE_SPACE+"</span>",g=f.dom;f.UndoManager=f.lang.Dispatcher.extend({constructor:function(b){this.editor=b,this.composer=b.composer,this.element=this.composer.element,this.history=[this.composer.getValue()],this.position=1,this.composer.commands.support("insertHTML")&&this._observe()},_observe:function(){var l,k=this,d=this.composer.sandbox.getDocument();if(g.observe(this.element,"keydown",function(j){if(!j.altKey&&(j.ctrlKey||j.metaKey)){var i=j.keyCode,m=90===i&&j.shiftKey||89===i;90!==i||j.shiftKey?m&&(k.redo(),j.preventDefault()):(k.undo(),j.preventDefault())}}),g.observe(this.element,"keydown",function(i){i=i.keyCode,i!==l&&(l=i,(8===i||46===i)&&k.transact())}),f.browser.hasUndoInContextMenu()){var c,b,a=function(){for(var i;i=d.querySelector("._wysihtml5-temp");){i.parentNode.removeChild(i)}clearInterval(c)};g.observe(this.element,"contextmenu",function(){a(),k.composer.selection.executeAndRestoreSimple(function(){k.element.lastChild&&k.composer.selection.setAfter(k.element.lastChild),d.execCommand("insertHTML",!1,e),d.execCommand("insertHTML",!1,h),d.execCommand("undo",!1,null)}),c=setInterval(function(){d.getElementById("_wysihtml5-redo")?(a(),k.redo()):d.getElementById("_wysihtml5-undo")||(a(),k.undo())},400),b||(b=!0,g.observe(document,"mousedown",a),g.observe(d,["mousedown","paste","cut","copy"],a))})}this.editor.observe("newword:composer",function(){k.transact()}).observe("beforecommand:composer",function(){k.transact()})},transact:function(){var d=this.history[this.position-1],c=this.composer.getValue();c!=d&&(40<(this.history.length=this.position)&&(this.history.shift(),this.position--),this.position++,this.history.push(c))},undo:function(){this.transact(),1>=this.position||(this.set(this.history[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.position>=this.history.length||(this.set(this.history[++this.position-1]),this.editor.fire("redo:composer"))},set:function(b){this.composer.setValue(b),this.editor.focus(!0)}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(e,d,f){this.parent=e,this.element=d,this.config=f,this._observeViewChange()},_observeViewChange:function(){var b=this;this.parent.observe("beforeload",function(){b.parent.observe("change_view",function(a){a===b.name?(b.parent.currentView=b,b.show(),setTimeout(function(){b.focus()},0)):b.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element){try{this.element.focus()}catch(b){}}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(e){var d=e.dom,f=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(h,g,i){this.base(h,g,i),this.textarea=this.parent.textarea,this._initSandbox()},clear:function(){this.element.innerHTML=f.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(a){var g=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);return a&&(g=this.parent.parse(g)),g=e.lang.string(g).replace(e.INVISIBLE_SPACE).by("")},setValue:function(g,c){c&&(g=this.parent.parse(g)),this.element.innerHTML=g},show:function(){this.iframe.style.display=this._displayStyle||"",this.disable(),this.enable()},hide:function(){this._displayStyle=d.getStyle("display").from(this.iframe),"none"===this._displayStyle&&(this._displayStyle=null),this.iframe.style.display="none"},disable:function(){this.element.removeAttribute("contentEditable"),this.base()},enable:function(){this.element.setAttribute("contentEditable","true"),this.base()},focus:function(a){e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var g=this.element.lastChild;a&&g&&("BR"===g.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return d.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")},isEmpty:function(){var b=this.element.innerHTML;return""===b||b===this.CARET_HACK||this.hasPlaceholderSet()||""===this.getTextContent()&&!this.element.querySelector("blockquote, ul, ol, img, embed, object, table, iframe, svg, video, audio, button, input, select, textarea")},_initSandbox:function(){var b=this;this.sandbox=new d.Sandbox(function(){b._create()},{stylesheets:this.config.stylesheets}),this.iframe=this.sandbox.getIframe();var h=document.createElement("input");h.type="hidden",h.name="_wysihtml5_mode",h.value=1;var g=this.textarea.element;d.insert(this.iframe).after(g),d.insert(h).after(g)},_create:function(){var b=this;this.doc=this.sandbox.getDocument(),this.element=this.doc.body,this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0),this.enable(),this.selection=new e.Selection(this.parent),this.commands=new e.Commands(this.parent),d.copyAttributes("className spellcheck title lang dir accessKey".split(" ")).from(this.textarea.element).to(this.element),d.addClass(this.element,this.config.composerClassName),this.config.style&&this.style(),this.observe();var a=this.config.name;a&&(d.addClass(this.element,a),d.addClass(this.iframe,a)),(a="string"==typeof this.config.placeholder?this.config.placeholder:this.textarea.element.getAttribute("placeholder"))&&d.simulatePlaceholder(this.parent,this,a),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element)&&setTimeout(function(){b.focus()},100),e.quirks.insertLineBreakOnReturn(this),f.clearsContentEditableCorrectly()||e.quirks.ensureProperClearing(this),f.clearsListsInContentEditableCorrectly()||e.quirks.ensureProperClearingOfLists(this),this.initSync&&this.config.sync&&this.initSync(),this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var l=this,k=f.canDisableAutoLinking(),j=f.doesAutoLinkingInContentEditable();if(k&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink){(!j||j&&k)&&this.parent.observe("newword:composer",function(){l.selection.executeAndRestore(function(g,h){d.autoLink(h.parentNode)})});var c=this.sandbox.getDocument().getElementsByTagName("a"),b=d.autoLink.URL_REG_EXP,a=function(g){return g=e.lang.string(d.getTextContent(g)).trim(),"www."===g.substr(0,4)&&(g="http://"+g),g};d.observe(this.element,"keydown",function(g){if(c.length){var i,g=l.selection.getSelectedNode(g.target.ownerDocument),h=d.getParentElement(g,{nodeName:"A"},4);h&&(i=a(h),setTimeout(function(){var m=a(h);m!==i&&m.match(b)&&h.setAttribute("href",m)},0))}})}},_initObjectResizing:function(){var c=["width","height"],b=c.length,a=this.element;this.commands.exec("enableObjectResizing",this.config.allowObjectResizing),this.config.allowObjectResizing?f.supportsEvent("resizeend")&&d.observe(a,"resizeend",function(i){for(var l,i=i.target||i.srcElement,k=i.style,j=0;b>j;j++){l=c[j],k[l]&&(i.setAttribute(l,parseInt(k[l],10)),k[l]="")}e.quirks.redraw(a)}):f.supportsEvent("resizestart")&&d.observe(a,"resizestart",function(g){g.preventDefault()})},_initUndoManager:function(){new e.UndoManager(this.parent)}})}(wysihtml5),function(t){var s=t.dom,r=document,q=window,p=r.createElement("div"),o="background-color color cursor font-family font-size font-style font-variant font-weight line-height letter-spacing text-align text-decoration text-indent text-rendering word-break word-wrap word-spacing".split(" "),n="background-color border-collapse border-bottom-color border-bottom-style border-bottom-width border-left-color border-left-style border-left-width border-right-color border-right-style border-right-width border-top-color border-top-style border-top-width clear display float margin-bottom margin-left margin-right margin-top outline-color outline-offset outline-width outline-style padding-left padding-right padding-top padding-bottom position top left right bottom z-index vertical-align text-align -webkit-box-sizing -moz-box-sizing -ms-box-sizing box-sizing -webkit-box-shadow -moz-box-shadow -ms-box-shadow box-shadow -webkit-border-top-right-radius -moz-border-radius-topright border-top-right-radius -webkit-border-bottom-right-radius -moz-border-radius-bottomright border-bottom-right-radius -webkit-border-bottom-left-radius -moz-border-radius-bottomleft border-bottom-left-radius -webkit-border-top-left-radius -moz-border-radius-topleft border-top-left-radius width height".split(" "),m="width height top left right bottom".split(" "),l=["html             { height: 100%; }","body             { min-height: 100%; padding: 0; margin: 0; margin-top: -1px; padding-top: 1px; }","._wysihtml5-temp { display: none; }",t.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","body[disabled]   { background-color: #eee !important; color: #999 !important; cursor: default !important; }","img:-moz-broken  { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],k=function(b){if(b.setActive){try{b.setActive()}catch(j){}}else{var i=b.style,d=r.documentElement.scrollTop||r.body.scrollTop,c=r.documentElement.scrollLeft||r.body.scrollLeft,i={position:i.position,top:i.top,left:i.left,WebkitUserSelect:i.WebkitUserSelect};s.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(b),b.focus(),s.setStyles(i).on(b),q.scrollTo&&q.scrollTo(c,d)}};t.views.Composer.prototype.style=function(){var c=this,b=r.querySelector(":focus"),a=this.textarea.element,g=a.hasAttribute("placeholder"),f=g&&a.getAttribute("placeholder");this.focusStylesHost=this.focusStylesHost||p.cloneNode(!1),this.blurStylesHost=this.blurStylesHost||p.cloneNode(!1),g&&a.removeAttribute("placeholder"),a===b&&a.blur(),s.copyStyles(n).from(a).to(this.iframe).andTo(this.blurStylesHost),s.copyStyles(o).from(a).to(this.element).andTo(this.blurStylesHost),s.insertCSS(l).into(this.element.ownerDocument),k(a),s.copyStyles(n).from(a).to(this.focusStylesHost),s.copyStyles(o).from(a).to(this.focusStylesHost);var e=t.lang.array(n).without(["display"]);if(b?b.focus():a.blur(),g&&a.setAttribute("placeholder",f),!t.browser.hasCurrentStyleProperty()){var d=s.observe(q,"resize",function(){if(s.contains(document.documentElement,c.iframe)){var h=s.getStyle("display").from(a),i=s.getStyle("display").from(c.iframe);a.style.display="",c.iframe.style.display="none",s.copyStyles(m).from(a).to(c.iframe).andTo(c.focusStylesHost).andTo(c.blurStylesHost),c.iframe.style.display=i,a.style.display=h}else{d.stop()}})}return this.parent.observe("focus:composer",function(){s.copyStyles(e).from(c.focusStylesHost).to(c.iframe),s.copyStyles(o).from(c.focusStylesHost).to(c.element)}),this.parent.observe("blur:composer",function(){s.copyStyles(e).from(c.blurStylesHost).to(c.iframe),s.copyStyles(o).from(c.blurStylesHost).to(c.element)}),this}}(wysihtml5),function(f){var e=f.dom,h=f.browser,g={66:"bold",73:"italic",85:"underline"};f.views.Composer.prototype.observe=function(){var p=this,o=this.getValue(),n=this.sandbox.getIframe(),m=this.element,d=h.supportsEventsInIframeCorrectly()?m:this.sandbox.getWindow(),c=h.supportsEvent("drop")?["drop","paste"]:["dragdrop","paste"];e.observe(n,"DOMNodeRemoved",function(){clearInterval(b),p.parent.fire("destroy:composer")});var b=setInterval(function(){e.contains(document.documentElement,n)||(clearInterval(b),p.parent.fire("destroy:composer"))},250);e.observe(d,"focus",function(){p.parent.fire("focus").fire("focus:composer"),setTimeout(function(){o=p.getValue()},0)}),e.observe(d,"blur",function(){o!==p.getValue()&&p.parent.fire("change").fire("change:composer"),p.parent.fire("blur").fire("blur:composer")}),f.browser.isIos()&&e.observe(m,"blur",function(){var j=m.ownerDocument.createElement("input"),i=document.documentElement.scrollTop||document.body.scrollTop,l=document.documentElement.scrollLeft||document.body.scrollLeft;try{p.selection.insertNode(j)}catch(k){m.appendChild(j)}j.focus(),j.parentNode.removeChild(j),window.scrollTo(l,i)}),e.observe(m,"dragenter",function(){p.parent.fire("unset_placeholder")}),h.firesOnDropOnlyWhenOnDragOverIsCancelled()&&e.observe(m,["dragover","dragenter"],function(i){i.preventDefault()}),e.observe(m,c,function(j){var i,k=j.dataTransfer;k&&h.supportsDataTransfer()&&(i=k.getData("text/html")||k.getData("text/plain")),i?(m.focus(),p.commands.exec("insertHTML",i),p.parent.fire("paste").fire("paste:composer"),j.stopPropagation(),j.preventDefault()):setTimeout(function(){p.parent.fire("paste").fire("paste:composer")},0)}),e.observe(m,"keyup",function(i){i=i.keyCode,(i===f.SPACE_KEY||i===f.ENTER_KEY)&&p.parent.fire("newword:composer")}),this.parent.observe("paste:composer",function(){setTimeout(function(){p.parent.fire("newword:composer")},0)}),h.canSelectImagesInContentEditable()||e.observe(m,"mousedown",function(j){var i=j.target;"IMG"===i.nodeName&&(p.selection.selectNode(i),j.preventDefault())}),e.observe(m,"keydown",function(j){var i=g[j.keyCode];(j.ctrlKey||j.metaKey)&&!j.altKey&&i&&(p.commands.exec(i),j.preventDefault())}),e.observe(m,"keydown",function(i){var k=p.selection.getSelectedNode(!0),j=i.keyCode;!k||"IMG"!==k.nodeName||j!==f.BACKSPACE_KEY&&j!==f.DELETE_KEY||(j=k.parentNode,j.removeChild(k),"A"===j.nodeName&&!j.firstChild&&j.parentNode.removeChild(j),setTimeout(function(){f.quirks.redraw(m)},0),i.preventDefault())});var a={IMG:"Image: ",A:"Link: "};e.observe(m,"mouseover",function(j){var j=j.target,i=j.nodeName;!("A"!==i&&"IMG"!==i)&&!j.hasAttribute("title")&&(i=a[i]+(j.getAttribute("href")||j.getAttribute("src")),j.setAttribute("title",i))})}}(wysihtml5),function(b){b.views.Synchronizer=Base.extend({constructor:function(e,d,f){this.editor=e,this.textarea=d,this.composer=f,this._observe()},fromComposerToTextarea:function(a){this.textarea.setValue(b.lang.string(this.composer.getValue()).trim(),a)},fromTextareaToComposer:function(d){var c=this.textarea.getValue();c?this.composer.setValue(c,d):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(c){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(c):this.fromComposerToTextarea(c)},_observe:function(){var a,j=this,i=this.textarea.element.form,h=function(){a=setInterval(function(){j.fromComposerToTextarea()},400)},g=function(){clearInterval(a),a=null};h(),i&&(b.dom.observe(i,"submit",function(){j.sync(!0)}),b.dom.observe(i,"reset",function(){setTimeout(function(){j.fromTextareaToComposer()},0)})),this.editor.observe("change_view",function(c){"composer"!==c||a?"textarea"===c&&(j.fromComposerToTextarea(!0),g()):(j.fromTextareaToComposer(!0),h())}),this.editor.observe("destroy:composer",g)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,d,f){this.base(e,d,f),this._observe()},clear:function(){this.element.value=""},getValue:function(d){var c=this.isEmpty()?"":this.element.value;return d&&(c=this.parent.parse(c)),c},setValue:function(d,c){c&&(d=this.parent.parse(d)),this.element.value=d},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),d=this.element.getAttribute("placeholder")||null,f=this.element.value;return e&&!f||f===d},isEmpty:function(){return !wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var f=this.element,e=this.parent,h={focusin:"focus",focusout:"blur"},g=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.observe("beforeload",function(){wysihtml5.dom.observe(f,g,function(b){b=h[b.type]||b.type,e.fire(b).fire(b+":textarea")}),wysihtml5.dom.observe(f,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}}),function(d){var c=d.dom;d.toolbar.Dialog=d.lang.Dispatcher.extend({constructor:function(f,e){this.link=f,this.container=e},_observe:function(){if(!this._observed){var l=this,k=function(f){var e=l._serialize();e==l.elementToChange?l.fire("edit",e):l.fire("save",e),l.hide(),f.preventDefault(),f.stopPropagation()};c.observe(l.link,"click",function(){c.hasClass(l.link,"wysihtml5-command-dialog-opened")&&setTimeout(function(){l.hide()},0)}),c.observe(this.container,"keydown",function(f){var g=f.keyCode;g===d.ENTER_KEY&&k(f),g===d.ESCAPE_KEY&&l.hide()}),c.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",k),c.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){l.fire("cancel"),l.hide(),e.preventDefault(),e.stopPropagation()});for(var j=this.container.querySelectorAll("input, select, textarea"),i=0,b=j.length,a=function(){clearInterval(l.interval)};b>i;i++){c.observe(j[i],"change",a)}this._observed=!0}},_serialize:function(){for(var f=this.elementToChange||{},e=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),h=e.length,g=0;h>g;g++){f[e[g].getAttribute("data-wysihtml5-dialog-field")]=e[g].value}return f},_interpolate:function(i){for(var h,n,m=document.querySelector(":focus"),l=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),k=l.length,j=0;k>j;j++){h=l[j],h!==m&&!(i&&"hidden"===h.type)&&(n=h.getAttribute("data-wysihtml5-dialog-field"),n=this.elementToChange?this.elementToChange[n]||"":h.defaultValue,h.value=n)}},show:function(b){var h=this,g=this.container.querySelector("input, select, textarea");if(this.elementToChange=b,this._observe(),this._interpolate(),b&&(this.interval=setInterval(function(){h._interpolate(!0)},500)),c.addClass(this.link,"wysihtml5-command-dialog-opened"),this.container.style.display="",this.fire("show"),g&&!b){try{g.focus()}catch(f){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,c.removeClass(this.link,"wysihtml5-command-dialog-opened"),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(h){var g=h.dom,l={position:"relative"},k={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},j={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},i={"x-webkit-speech":"",speech:""};h.toolbar.Speech=function(d,c){var b=document.createElement("input");if(h.browser.supportsSpeechApiOn(b)){var a=document.createElement("div");h.lang.object(k).merge({width:c.offsetWidth+"px",height:c.offsetHeight+"px"}),g.insert(b).into(a),g.insert(a).into(c),g.setStyles(j).on(b),g.setAttributes(i).on(b),g.setStyles(k).on(a),g.setStyles(l).on(c),g.observe(b,"onwebkitspeechchange" in b?"webkitspeechchange":"speechchange",function(){d.execCommand("insertText",b.value),b.value=""}),g.observe(b,"click",function(e){g.hasClass(c,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}else{c.style.display="none"}}}(wysihtml5),function(d){var c=d.dom;d.toolbar.Toolbar=Base.extend({constructor:function(a,j){this.editor=a,this.container="string"==typeof j?document.getElementById(j):j,this.composer=a.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),this.show();for(var i=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),h=i.length,g=0;h>g;g++){new d.toolbar.Speech(this,i[g])}},_getLinks:function(t){for(var s,r,q,p,o,n=this[t+"Links"]=d.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+t+"]")).get(),m=n.length,l=0,a=this[t+"Mapping"]={};m>l;l++){s=n[l],q=s.getAttribute("data-wysihtml5-"+t),p=s.getAttribute("data-wysihtml5-"+t+"-value"),r=this.container.querySelector("[data-wysihtml5-"+t+"-group='"+q+"']"),o=this._getDialog(s,q),a[q+":"+p]={link:s,group:r,name:q,value:p,dialog:o,state:!1}}},_getDialog:function(a,l){var k,j,i=this,h=this.container.querySelector("[data-wysihtml5-dialog='"+l+"']");return h&&(k=new d.toolbar.Dialog(a,h),k.observe("show",function(){j=i.composer.selection.getBookmark(),i.editor.fire("show:dialog",{command:l,dialogContainer:h,commandLink:a})}),k.observe("save",function(b){j&&i.composer.selection.setBookmark(j),i._execCommand(l,b),i.editor.fire("save:dialog",{command:l,dialogContainer:h,commandLink:a})}),k.observe("cancel",function(){i.editor.focus(!1),i.editor.fire("cancel:dialog",{command:l,dialogContainer:h,commandLink:a})})),k},execCommand:function(f,e){if(!this.commandsDisabled){var g=this.commandMapping[f+":"+e];g&&g.dialog&&!g.state?g.dialog.show():this._execCommand(f,e)}},_execCommand:function(f,e){this.editor.focus(!1),this.composer.commands.exec(f,e),this._updateLinkStates()},execAction:function(f){var e=this.editor;switch(f){case"change_view":e.currentView===e.textarea?e.fire("change_view","composer"):e.fire("change_view","textarea")}},_observe:function(){for(var b=this,l=this.editor,k=this.container,j=this.commandLinks.concat(this.actionLinks),i=j.length,h=0;i>h;h++){c.setAttributes({href:"javascript:;",unselectable:"on"}).on(j[h])}c.delegate(k,"[data-wysihtml5-command]","mousedown",function(e){e.preventDefault()}),c.delegate(k,"[data-wysihtml5-command]","click",function(a){var f=this.getAttribute("data-wysihtml5-command"),e=this.getAttribute("data-wysihtml5-command-value");b.execCommand(f,e),a.preventDefault()}),c.delegate(k,"[data-wysihtml5-action]","click",function(a){var e=this.getAttribute("data-wysihtml5-action");b.execAction(e),a.preventDefault()}),l.observe("focus:composer",function(){b.bookmark=null,clearInterval(b.interval),b.interval=setInterval(function(){b._updateLinkStates()},500)}),l.observe("blur:composer",function(){clearInterval(b.interval)}),l.observe("destroy:composer",function(){clearInterval(b.interval)}),l.observe("change_view",function(a){setTimeout(function(){b.commandsDisabled="composer"!==a,b._updateLinkStates(),b.commandsDisabled?c.addClass(k,"wysihtml5-commands-disabled"):c.removeClass(k,"wysihtml5-commands-disabled")},0)})},_updateLinkStates:function(){var j,i,h,b=this.commandMapping,a=this.actionMapping;for(j in b){h=b[j],this.commandsDisabled?(i=!1,c.removeClass(h.link,"wysihtml5-command-active"),h.group&&c.removeClass(h.group,"wysihtml5-command-active"),h.dialog&&h.dialog.hide()):(i=this.composer.commands.state(h.name,h.value),d.lang.object(i).isArray()&&(i=1===i.length?i[0]:!0),c.removeClass(h.link,"wysihtml5-command-disabled"),h.group&&c.removeClass(h.group,"wysihtml5-command-disabled")),h.state!==i&&((h.state=i)?(c.addClass(h.link,"wysihtml5-command-active"),h.group&&c.addClass(h.group,"wysihtml5-command-active"),h.dialog&&("object"==typeof i?h.dialog.show(i):h.dialog.hide())):(c.removeClass(h.link,"wysihtml5-command-active"),h.group&&c.removeClass(h.group,"wysihtml5-command-active"),h.dialog&&h.dialog.hide()))}for(j in a){b=a[j],"change_view"===b.name&&(b.state=this.editor.currentView===this.editor.textarea,b.state?c.addClass(b.link,"wysihtml5-action-active"):c.removeClass(b.link,"wysihtml5-action-active"))}},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(d){var c={name:void 0,style:!0,toolbar:void 0,autoLink:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:d.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",stylesheets:[],placeholderText:void 0,allowObjectResizing:!0,supportTouchDevices:!0};d.Editor=d.lang.Dispatcher.extend({constructor:function(h,g){if(this.textareaElement="string"==typeof h?document.getElementById(h):h,this.config=d.lang.object({}).merge(c).merge(g).get(),this.currentView=this.textarea=new d.views.Textarea(this,this.textareaElement,this.config),this._isCompatible=d.browser.supported(),!this._isCompatible||!this.config.supportTouchDevices&&d.browser.isTouchDevice()){var b=this;setTimeout(function(){b.fire("beforeload").fire("load")},0)}else{d.dom.addClass(document.body,this.config.bodyClassName),this.currentView=this.composer=new d.views.Composer(this,this.textareaElement,this.config),"function"==typeof this.config.parser&&this._initParser(),this.observe("beforeload",function(){this.synchronizer=new d.views.Synchronizer(this,this.textarea,this.composer),this.config.toolbar&&(this.toolbar=new d.toolbar.Toolbar(this,this.config.toolbar))});try{console.log("Heya! This page is using wysihtml5 for rich text editing. Check out https://github.com/xing/wysihtml5")}catch(a){}}},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(b){return this.currentView.getValue(b)},setValue:function(f,e){return f?(this.currentView.setValue(f,e),this):this.clear()},focus:function(b){return this.currentView.focus(b),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(a){var e=this.config.parser(a,this.config.parserRules,this.composer.sandbox.getDocument(),!0);return"object"==typeof a&&d.quirks.redraw(a),e},_initParser:function(){this.observe("paste:composer",function(){var a=this;a.composer.selection.executeAndRestore(function(){d.quirks.cleanPastedHTML(a.composer.element),a.parse(a.composer.element)},!0)}),this.observe("paste:textarea",function(){this.textarea.setValue(this.parse(this.textarea.getValue()))})}})}(wysihtml5);var Handlebars=function(){var h=function(){function d(b){this.string=b}var c;return d.prototype.toString=function(){return""+this.string},c=d}(),g=function(z){function y(b){return s[b]||"&amp;"}function x(e,d){for(var f in d){d.hasOwnProperty(f)&&(e[f]=d[f])}}function w(b){return b instanceof t?b.toString():b||0===b?(b=""+b,q.test(b)?b.replace(r,y):b):""}function v(b){return b||0===b?n(b)&&0===b.length?!0:!1:!0}var u={},t=z,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=/[&<>"'`]/g,q=/[&<>"'`]/;u.extend=x;var p=Object.prototype.toString;u.toString=p;var o=function(b){return"function"==typeof b};o(/x/)&&(o=function(b){return"function"==typeof b&&"[object Function]"===p.call(b)});var o;u.isFunction=o;var n=Array.isArray||function(b){return b&&"object"==typeof b?"[object Array]"===p.call(b):!1};return u.isArray=n,u.escapeExpression=w,u.isEmpty=v,u}(h),l=function(){function e(){for(var m=Error.prototype.constructor.apply(this,arguments),c=0;c<f.length;c++){this[f[c]]=m[f[c]]}}var d,f=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,d=e}(),k=function(H,G){function F(d,c){this.helpers=d||{},this.partials=c||{},E(this)}function E(b){b.registerHelper("helperMissing",function(c){if(2===arguments.length){return void 0}throw new Error("Missing helper: '"+c+"'")}),b.registerHelper("blockHelperMissing",function(a,n){var m=n.inverse||function(){},f=n.fn;return v(a)&&(a=a.call(this)),a===!0?f(this):a===!1||null==a?m(this):w(a)?a.length>0?b.helpers.each(a,n):m(this):f(a)}),b.registerHelper("each",function(L,K){var J,I=K.fn,q=K.inverse,p=0,o="";if(v(L)&&(L=L.call(this)),K.data&&(J=r(K.data)),L&&"object"==typeof L){if(w(L)){for(var n=L.length;n>p;p++){J&&(J.index=p,J.first=0===p,J.last=p===L.length-1),o+=I(L[p],{data:J})}}else{for(var m in L){L.hasOwnProperty(m)&&(J&&(J.key=m),o+=I(L[m],{data:J}),p++)}}}return 0===p&&(o=q(this)),o}),b.registerHelper("if",function(d,c){return v(d)&&(d=d.call(this)),!c.hash.includeZero&&!d||B.isEmpty(d)?c.inverse(this):c.fn(this)}),b.registerHelper("unless",function(a,d){return b.helpers["if"].call(this,a,{fn:d.inverse,inverse:d.fn,hash:d.hash})}),b.registerHelper("with",function(d,c){return v(d)&&(d=d.call(this)),B.isEmpty(d)?void 0:c.fn(d)}),b.registerHelper("log",function(a,f){var e=f.data&&null!=f.data.level?parseInt(f.data.level,10):1;b.log(e,a)})}function D(d,c){s.log(d,c)}var C={},B=H,A=G,z="1.1.2";C.VERSION=z;var y=4;C.COMPILER_REVISION=y;var x={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};C.REVISION_CHANGES=x;var w=B.isArray,v=B.isFunction,u=B.toString,t="[object Object]";C.HandlebarsEnvironment=F,F.prototype={constructor:F,logger:s,log:D,registerHelper:function(e,d,f){if(u.call(e)===t){if(f||d){throw new A("Arg not supported with multiple helpers")}B.extend(this.helpers,e)}else{f&&(d.not=f),this.helpers[e]=d}},registerPartial:function(d,c){u.call(d)===t?B.extend(this.partials,d):this.partials[d]=c}};var s={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,d){if(s.level<=e){var f=s.methodMap[e];"undefined"!=typeof console&&console[f]&&console[f].call(console,d)}}};C.logger=s,C.log=D;var r=function(d){var c={};return B.extend(c,d),c};return C.createFrame=r,C}(g,l),j=function(B,A,z){function y(m){var f=m&&m[0]||1,D=p;if(f!==D){if(D>f){var C=o[D],n=o[f];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+C+") or downgrade your runtime to an older version ("+n+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+m[1]+").")}}function x(f,d){if(!d){throw new Error("No environment passed to template")}var n;n=d.compile?function(b,I,H,G,F,E){var D=u.apply(this,arguments);if(D){return D}var C={helpers:G,partials:F,data:E};return F[I]=d.compile(b,{data:void 0!==E},d),F[I](H,C)}:function(C,e){var D=u.apply(this,arguments);if(D){return D}throw new q("The partial "+e+" could not be compiled when running in runtime-only mode")};var m={escapeExpression:r.escapeExpression,invokePartial:n,programs:[],program:function(C,e,E){var D=this.programs[C];return E?D=v(C,e,E):D||(D=this.programs[C]=v(C,e)),D},merge:function(C,e){var D=C||e;return C&&e&&C!==e&&(D={},r.extend(D,e),r.extend(D,C)),D},programWithDepth:w,noop:t,compilerInfo:null};return function(E,D){D=D||{};var C,e,b=D.partial?D:d;D.partial||(C=D.helpers,e=D.partials);var a=f.call(m,b,E,C,e,D.data);return D.partial||y(m.compilerInfo),a}}function w(m,f,D){var C=Array.prototype.slice.call(arguments,3),n=function(b,c){return c=c||{},f.apply(this,[b,c.data||D].concat(C))};return n.program=m,n.depth=C.length,n}function v(f,e,n){var m=function(b,c){return c=c||{},e(b,c.data||n)};return m.program=f,m.depth=0,m}function u(n,m,G,F,E,D){var C={partial:!0,helpers:F,partials:E,data:D};if(void 0===n){throw new q("The partial "+m+" could not be found")}return n instanceof Function?n(G,C):void 0}function t(){return""}var s={},r=B,q=A,p=z.COMPILER_REVISION,o=z.REVISION_CHANGES;return s.template=x,s.programWithDepth=w,s.program=v,s.invokePartial=u,s.noop=t,s}(g,l,k),i=function(z,y,x,w,v){var u,t=z,s=y,r=x,q=w,p=v,o=function(){var b=new t.HandlebarsEnvironment;return q.extend(b,t),b.SafeString=s,b.Exception=r,b.Utils=q,b.VM=p,b.template=function(a){return p.template(a,b)},b},n=o();return n.create=o,u=n}(k,h,l,g,j);return i}(),glob="undefined"==typeof window?global:window,Handlebars=glob.Handlebars||require("handlebars");this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.color=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.black,typeof r===o?r.apply(w):r))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.black,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.silver,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.gray,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.maroon,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.red,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.purple,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.green,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.olive,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.navy,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.blue,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.colours,r=null==r||r===!1?r:r.orange,typeof r===o?r.apply(w):r))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.emphasis=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="btn-group">\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.emphasis,r=null==r||r===!1?r:r.bold,typeof r===o?r.apply(w):r))+'</a>\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.emphasis,r=null==r||r===!1?r:r.italic,typeof r===o?r.apply(w):r))+'</a>\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.emphasis,r=null==r||r===!1?r:r.underline,typeof r===o?r.apply(w):r))+"</a>\n  </div>\n</li>\n"}),this.wysihtml5.tpl["font-styles"]=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+='" data-toggle="dropdown">\n    <span class="glyphicon glyphicon-font"></span>\n    <span class="current-font">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.normal,typeof r===o?r.apply(w):r))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="div" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.normal,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h1,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h2,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h3,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h4,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h5,typeof r===o?r.apply(w):r))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.font_styles,r=null==r||r===!1?r:r.h6,typeof r===o?r.apply(w):r))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.html=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="btn-group">\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-action="change_view" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.html,r=null==r||r===!1?r:r.edit,typeof r===o?r.apply(w):r))+'" tabindex="-1">\n      <span class="glyphicon glyphicon-pencil"></span>\n    </a>\n  </div>\n</li>\n'}),this.wysihtml5.tpl.image=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade">\n    <div class="modal-dialog">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+n((r=w&&w.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(w):r))+'</h3>\n        </div>\n        <div class="modal-body">\n          <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control">\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.cancel,typeof r===o?r.apply(w):r))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(w):r))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="insertImage" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.image,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(w):r))+'" tabindex="-1">\n    <span class="glyphicon glyphicon-picture"></span>\n  </a>\n</li>\n'}),this.wysihtml5.tpl.link=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade">\n    <div class="modal-dialog">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+n((r=w&&w.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(w):r))+'</h3>\n        </div>\n        <div class="modal-body">\n          <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control">\n          <label class="checkbox"> <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+n((r=w&&w.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.target,typeof r===o?r.apply(w):r))+'</label>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.cancel,typeof r===o?r.apply(w):r))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal">'+n((r=w&&w.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(w):r))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="createLink" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.link,r=null==r||r===!1?r:r.insert,typeof r===o?r.apply(w):r))+'" tabindex="-1">\n    <span class="glyphicon glyphicon-share"></span>\n  </a>\n</li>\n'}),this.wysihtml5.tpl.lists=Handlebars.template(function(x,w,v,u,t){function s(e){var d,f="";return f+="btn-"+n((d=e&&e.options,d=null==d||d===!1?d:d.size,typeof d===o?d.apply(e):d))}this.compilerInfo=[4,">= 1.0.0"],v=this.merge(v,x.helpers),t=t||{};var r,q,p="",o="function",n=this.escapeExpression,m=this;return p+='<li>\n  <div class="btn-group">\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.unordered,typeof r===o?r.apply(w):r))+'" tabindex="-1"><span class="glyphicon glyphicon-list"></span></a>\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.ordered,typeof r===o?r.apply(w):r))+'" tabindex="-1"><span class="glyphicon glyphicon-th-list"></span></a>\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="Outdent" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.outdent,typeof r===o?r.apply(w):r))+'" tabindex="-1"><span class="glyphicon glyphicon-indent-right"></span></a>\n    <a class="btn ',q=v["if"].call(w,(r=w&&w.options,null==r||r===!1?r:r.size),{hash:{},inverse:m.noop,fn:m.program(1,s,t),data:t}),(q||0===q)&&(p+=q),p+=' btn-default" data-wysihtml5-command="Indent" title="'+n((r=w&&w.locale,r=null==r||r===!1?r:r.lists,r=null==r||r===!1?r:r.indent,typeof r===o?r.apply(w):r))+'" tabindex="-1"><span class="glyphicon glyphicon-indent-left"></span></a>\n  </div>\n</li>\n'}),"object"==typeof exports&&exports&&(module.exports=this.wysihtml5.tpl),!function(i,h){var n=function(b,f,e){return h.tpl[b]({locale:f,options:e})},m=function(o,f){this.el=o;var b=f||k;for(var a in b.customTemplates){h.tpl[a]=b.customTemplates[a]}this.toolbar=this.createToolbar(o,b),this.editor=this.createEditor(f),window.editor=this.editor,i("iframe.wysihtml5-sandbox").each(function(d,e){i(e.contentWindow).off("focus.wysihtml5").on({"focus.wysihtml5":function(){i("li.dropdown").removeClass("open")}})})};m.prototype={constructor:m,createEditor:function(f){f=f||{},f=i.extend(!0,{},f),f.toolbar=this.toolbar[0];var b=new h.Editor(this.el[0],f);if(f&&f.events){for(var a in f.events){b.on(a,f.events[a])}}return b},createToolbar:function(a,q){var p=this,o=i("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),g=q.locale||k.locale||"en";for(var f in k){var c=!1;void 0!==q[f]?q[f]===!0&&(c=!0):c=k[f],c===!0&&(o.append(n(f,j[g],q)),"html"===f&&this.initHtml(o),"link"===f&&this.initInsertLink(o),"image"===f&&this.initInsertImage(o))}if(q.toolbar){for(f in q.toolbar){o.append(q.toolbar[f])}}return o.find('a[data-wysihtml5-command="formatBlock"]').click(function(e){var s=e.target||e.srcElement,r=i(s);p.toolbar.find(".current-font").text(r.html())}),o.find('a[data-wysihtml5-command="foreColor"]').click(function(e){var s=e.target||e.srcElement,r=i(s);p.toolbar.find(".current-color").text(r.html())}),this.el.before(o),o},initHtml:function(d){var c='a[data-wysihtml5-action="change_view"]';d.find(c).click(function(){d.find("a.btn").not(c).toggleClass("disabled")})},initInsertImage:function(a){var u,t=this,s=a.find(".bootstrap-wysihtml5-insert-image-modal"),r=s.find(".bootstrap-wysihtml5-insert-image-url"),q=s.find("a.btn-primary"),p=r.val(),o=function(){var b=r.val();r.val(p),t.editor.currentView.element.focus(),u&&(t.editor.composer.selection.setBookmark(u),u=null),t.editor.composer.commands.exec("insertImage",b)};r.keypress(function(b){13==b.which&&(o(),s.modal("hide"))}),q.click(o),s.on("shown",function(){r.focus()}),s.on("hide",function(){t.editor.currentView.element.focus()}),a.find("a[data-wysihtml5-command=insertImage]").click(function(){var c=i(this).hasClass("wysihtml5-command-active");return c?!0:(t.editor.currentView.element.focus(!1),u=t.editor.composer.selection.getBookmark(),s.appendTo("body").modal("show"),s.on("click.dismiss.modal",'[data-dismiss="modal"]',function(b){b.stopPropagation()}),!1)})},initInsertLink:function(v){var u,t=this,s=v.find(".bootstrap-wysihtml5-insert-link-modal"),r=s.find(".bootstrap-wysihtml5-insert-link-url"),q=s.find(".bootstrap-wysihtml5-insert-link-target"),p=s.find("a.btn-primary"),o=r.val(),a=function(){var d=r.val();r.val(o),t.editor.currentView.element.focus(),u&&(t.editor.composer.selection.setBookmark(u),u=null);var c=q.prop("checked");t.editor.composer.commands.exec("createLink",{href:d,target:c?"_blank":"_self",rel:c?"nofollow":""})};r.keypress(function(b){13==b.which&&(a(),s.modal("hide"))}),p.click(a),s.on("shown",function(){r.focus()}),s.on("hide",function(){t.editor.currentView.element.focus()}),v.find("a[data-wysihtml5-command=createLink]").click(function(){var c=i(this).hasClass("wysihtml5-command-active");return c?!0:(t.editor.currentView.element.focus(!1),u=t.editor.composer.selection.getBookmark(),s.appendTo("body").modal("show"),s.on("click.dismiss.modal",'[data-dismiss="modal"]',function(b){b.stopPropagation()}),!1)})}};var l={resetDefaults:function(){i.fn.wysihtml5.defaultOptions=i.extend(!0,{},i.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(a){return this.each(function(){var b=i(this);b.data("wysihtml5",new m(b,a))})},shallowExtend:function(a){var f=i.extend({},i.fn.wysihtml5.defaultOptions,a||{},i(this).data()),e=this;return l.bypassDefaults.apply(e,[f])},deepExtend:function(a){var f=i.extend(!0,{},i.fn.wysihtml5.defaultOptions,a||{}),e=this;return l.bypassDefaults.apply(e,[f])},init:function(d){var c=this;return l.shallowExtend.apply(c,[d])}};i.fn.wysihtml5=function(a){return l[a]?l[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?(i.error("Method "+a+" does not exist on jQuery.wysihtml5"),void 0):l.init.apply(this,arguments)},i.fn.wysihtml5.Constructor=m;var k=i.fn.wysihtml5.defaultOptions={"font-styles":!0,color:!1,emphasis:!0,lists:!0,html:!1,link:!0,image:!0,events:{},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,code:1,pre:1}},locale:"en"};"undefined"==typeof i.fn.wysihtml5.defaultOptionsCache&&(i.fn.wysihtml5.defaultOptionsCache=i.extend(!0,{},i.fn.wysihtml5.defaultOptions));var j=i.fn.wysihtml5.locale={}}(window.jQuery,window.wysihtml5),function(b){b.fn.wysihtml5.locale.en=b.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}(jQuery);