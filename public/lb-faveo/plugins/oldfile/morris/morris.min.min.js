(function(){var p,n,r,k,o=[].slice,m=function(b,a){return function(){return b.apply(a,arguments)}},l={}.hasOwnProperty,q=function(a,c){for(var d in c){if(l.call(c,d)){a[d]=c[d]}}function b(){this.constructor=a}b.prototype=c.prototype;a.prototype=new b();a.__super__=c.prototype;return a},j=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++){if(b in this&&this[b]===a){return b}}return -1};n=window.Morris={};p=jQuery;n.EventEmitter=(function(){function a(){}a.prototype.on=function(c,b){if(this.handlers==null){this.handlers={}}if(this.handlers[c]==null){this.handlers[c]=[]}this.handlers[c].push(b);return this};a.prototype.fire=function(){var h,g,b,e,c,f,d;b=arguments[0],h=2<=arguments.length?o.call(arguments,1):[];if((this.handlers!=null)&&(this.handlers[b]!=null)){f=this.handlers[b];d=[];for(e=0,c=f.length;e<c;e++){g=f[e];d.push(g.apply(null,h))}return d}};return a})();n.commas=function(b){var a,c,d,e;if(b!=null){d=b<0?"-":"";a=Math.abs(b);c=Math.floor(a).toFixed(0);d+=c.replace(/(?=(?:\d{3})+$)(?!^)/g,",");e=a.toString();if(e.length>c.length){d+=e.slice(c.length)}return d}else{return"-"}};n.pad2=function(a){return(a<10?"0":"")+a};n.Grid=(function(a){q(b,a);function b(d){this.resizeHandler=m(this.resizeHandler,this);var c=this;if(typeof d.element==="string"){this.el=p(document.getElementById(d.element))}else{this.el=p(d.element)}if((this.el==null)||this.el.length===0){throw new Error("Graph container element not found")}if(this.el.css("position")==="static"){this.el.css("position","relative")}this.options=p.extend({},this.gridDefaults,this.defaults||{},d);if(typeof this.options.units==="string"){this.options.postUnits=d.units}this.raphael=new Raphael(this.el[0]);this.elementWidth=null;this.elementHeight=null;this.dirty=false;this.selectFrom=null;if(this.init){this.init()}this.setData(this.options.data);this.el.bind("mousemove",function(i){var f,e,h,g,t;e=c.el.offset();t=i.pageX-e.left;if(c.selectFrom){f=c.data[c.hitTest(Math.min(t,c.selectFrom))]._x;h=c.data[c.hitTest(Math.max(t,c.selectFrom))]._x;g=h-f;return c.selectionRect.attr({x:f,width:g})}else{return c.fire("hovermove",t,i.pageY-e.top)}});this.el.bind("mouseleave",function(e){if(c.selectFrom){c.selectionRect.hide();c.selectFrom=null}return c.fire("hoverout")});this.el.bind("touchstart touchmove touchend",function(g){var f,e;e=g.originalEvent.touches[0]||g.originalEvent.changedTouches[0];f=c.el.offset();return c.fire("hovermove",e.pageX-f.left,e.pageY-f.top)});this.el.bind("click",function(f){var e;e=c.el.offset();return c.fire("gridclick",f.pageX-e.left,f.pageY-e.top)});if(this.options.rangeSelect){this.selectionRect=this.raphael.rect(0,0,0,this.el.innerHeight()).attr({fill:this.options.rangeSelectColor,stroke:false}).toBack().hide();this.el.bind("mousedown",function(f){var e;e=c.el.offset();return c.startRange(f.pageX-e.left)});this.el.bind("mouseup",function(f){var e;e=c.el.offset();c.endRange(f.pageX-e.left);return c.fire("hovermove",f.pageX-e.left,f.pageY-e.top)})}if(this.options.resize){p(window).bind("resize",function(e){if(c.timeoutId!=null){window.clearTimeout(c.timeoutId)}return c.timeoutId=window.setTimeout(c.resizeHandler,100)})}this.el.css("-webkit-tap-highlight-color","rgba(0,0,0,0)");if(this.postInit){this.postInit()}}b.prototype.gridDefaults={dateFormat:null,axes:true,grid:true,gridLineColor:"#aaa",gridStrokeWidth:0.5,gridTextColor:"#888",gridTextSize:12,gridTextFamily:"sans-serif",gridTextWeight:"normal",hideHover:false,yLabelFormat:null,xLabelAngle:0,numLines:5,padding:25,parseTime:true,postUnits:"",preUnits:"",ymax:"auto",ymin:"auto 0",goals:[],goalStrokeWidth:1,goalLineColors:["#666633","#999966","#cc6666","#663333"],events:[],eventStrokeWidth:1,eventLineColors:["#005a04","#ccffbb","#3a5f0b","#005502"],rangeSelect:null,rangeSelectColor:"#eef",resize:false};b.prototype.setData=function(g,i){var c,F,e,J,f,L,d,D,H,I,y,E,G,K,h;if(i==null){i=true}this.options.data=g;if((g==null)||g.length===0){this.data=[];this.raphael.clear();if(this.hover!=null){this.hover.hide()}return}E=this.cumulative?0:null;G=this.cumulative?0:null;if(this.options.goals.length>0){f=Math.min.apply(Math,this.options.goals);J=Math.max.apply(Math,this.options.goals);G=G!=null?Math.min(G,f):f;E=E!=null?Math.max(E,J):J}this.data=(function(){var s,t,u;u=[];for(e=s=0,t=g.length;s<t;e=++s){d=g[e];L={src:d};L.label=d[this.options.xkey];if(this.options.parseTime){L.x=n.parseDate(L.label);if(this.options.dateFormat){L.label=this.options.dateFormat(L.x)}else{if(typeof L.label==="number"){L.label=new Date(L.label).toString()}}}else{L.x=e;if(this.options.xLabelFormat){L.label=this.options.xLabelFormat(L)}}H=0;L.y=(function(){var w,z,v,x;v=this.options.ykeys;x=[];for(F=w=0,z=v.length;w<z;F=++w){y=v[F];K=d[y];if(typeof K==="string"){K=parseFloat(K)}if((K!=null)&&typeof K!=="number"){K=null}if(K!=null){if(this.cumulative){H+=K}else{if(E!=null){E=Math.max(K,E);G=Math.min(K,G)}else{E=G=K}}}if(this.cumulative&&(H!=null)){E=Math.max(H,E);G=Math.min(H,G)}x.push(K)}return x}).call(this);u.push(L)}return u}).call(this);if(this.options.parseTime){this.data=this.data.sort(function(s,t){return(s.x>t.x)-(t.x>s.x)})}this.xmin=this.data[0].x;this.xmax=this.data[this.data.length-1].x;this.events=[];if(this.options.events.length>0){if(this.options.parseTime){this.events=(function(){var s,u,t,v;t=this.options.events;v=[];for(s=0,u=t.length;s<u;s++){c=t[s];v.push(n.parseDate(c))}return v}).call(this)}else{this.events=this.options.events}this.xmax=Math.max(this.xmax,Math.max.apply(Math,this.events));this.xmin=Math.min(this.xmin,Math.min.apply(Math,this.events))}if(this.xmin===this.xmax){this.xmin-=1;this.xmax+=1}this.ymin=this.yboundary("min",G);this.ymax=this.yboundary("max",E);if(this.ymin===this.ymax){if(G){this.ymin-=1}this.ymax+=1}if(((h=this.options.axes)===true||h==="both"||h==="y")||this.options.grid===true){if(this.options.ymax===this.gridDefaults.ymax&&this.options.ymin===this.gridDefaults.ymin){this.grid=this.autoGridLines(this.ymin,this.ymax,this.options.numLines);this.ymin=Math.min(this.ymin,this.grid[0]);this.ymax=Math.max(this.ymax,this.grid[this.grid.length-1])}else{D=(this.ymax-this.ymin)/(this.options.numLines-1);this.grid=(function(){var t,v,s,u;u=[];for(I=t=v=this.ymin,s=this.ymax;D>0?t<=s:t>=s;I=t+=D){u.push(I)}return u}).call(this)}}this.dirty=true;if(i){return this.redraw()}};b.prototype.yboundary=function(e,c){var f,d;f=this.options["y"+e];if(typeof f==="string"){if(f.slice(0,4)==="auto"){if(f.length>5){d=parseInt(f.slice(5),10);if(c==null){return d}return Math[e](c,d)}else{if(c!=null){return c}else{return 0}}}else{return parseInt(f,10)}}else{return f}};b.prototype.autoGridLines=function(z,h,c){var y,e,i,f,A,g,B,d,x;A=h-z;x=Math.floor(Math.log(A)/Math.log(10));B=Math.pow(10,x);e=Math.floor(z/B)*B;y=Math.ceil(h/B)*B;g=(y-e)/(c-1);if(B===1&&g>1&&Math.ceil(g)!==g){g=Math.ceil(g);y=e+g*(c-1)}if(e<0&&y>0){e=Math.floor(z/g)*g;y=Math.ceil(h/g)*g}if(g<1){f=Math.floor(Math.log(g)/Math.log(10));i=(function(){var t,s;s=[];for(d=t=e;g>0?t<=y:t>=y;d=t+=g){s.push(parseFloat(d.toFixed(1-f)))}return s})()}else{i=(function(){var t,s;s=[];for(d=t=e;g>0?t<=y:t>=y;d=t+=g){s.push(d)}return s})()}return i};b.prototype._calc=function(){var e,f,h,i,c,t,g,d;c=this.el.width();h=this.el.height();if(this.elementWidth!==c||this.elementHeight!==h||this.dirty){this.elementWidth=c;this.elementHeight=h;this.dirty=false;this.left=this.options.padding;this.right=this.elementWidth-this.options.padding;this.top=this.options.padding;this.bottom=this.elementHeight-this.options.padding;if((g=this.options.axes)===true||g==="both"||g==="y"){t=(function(){var s,x,z,y;z=this.grid;y=[];for(s=0,x=z.length;s<x;s++){f=z[s];y.push(this.measureText(this.yAxisFormat(f)).width)}return y}).call(this);this.left+=Math.max.apply(Math,t)}if((d=this.options.axes)===true||d==="both"||d==="x"){e=(function(){var w,s,x;x=[];for(i=w=0,s=this.data.length;0<=s?w<s:w>s;i=0<=s?++w:--w){x.push(this.measureText(this.data[i].text,-this.options.xLabelAngle).height)}return x}).call(this);this.bottom-=Math.max.apply(Math,e)}this.width=Math.max(1,this.right-this.left);this.height=Math.max(1,this.bottom-this.top);this.dx=this.width/(this.xmax-this.xmin);this.dy=this.height/(this.ymax-this.ymin);if(this.calc){return this.calc()}}};b.prototype.transY=function(c){return this.bottom-(c-this.ymin)*this.dy};b.prototype.transX=function(c){if(this.data.length===1){return(this.left+this.right)/2}else{return this.left+(c-this.xmin)*this.dx}};b.prototype.redraw=function(){this.raphael.clear();this._calc();this.drawGrid();this.drawGoals();this.drawEvents();if(this.draw){return this.draw()}};b.prototype.measureText=function(e,f){var d,c;if(f==null){f=0}c=this.raphael.text(100,100,e).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).rotate(f);d=c.getBBox();c.remove();return d};b.prototype.yAxisFormat=function(c){return this.yLabelFormat(c)};b.prototype.yLabelFormat=function(c){if(typeof this.options.yLabelFormat==="function"){return this.options.yLabelFormat(c)}else{return""+this.options.preUnits+(n.commas(c))+this.options.postUnits}};b.prototype.drawGrid=function(){var i,e,g,t,h,d,f,c;if(this.options.grid===false&&((h=this.options.axes)!==true&&h!=="both"&&h!=="y")){return}d=this.grid;c=[];for(g=0,t=d.length;g<t;g++){i=d[g];e=this.transY(i);if((f=this.options.axes)===true||f==="both"||f==="y"){this.drawYAxisLabel(this.left-this.options.padding/2,e,this.yAxisFormat(i))}if(this.options.grid){c.push(this.drawGridLine("M"+this.left+","+e+"H"+(this.left+this.width)))}else{c.push(void 0)}}return c};b.prototype.drawGoals=function(){var i,h,g,e,c,f,d;f=this.options.goals;d=[];for(g=e=0,c=f.length;e<c;g=++e){h=f[g];i=this.options.goalLineColors[g%this.options.goalLineColors.length];d.push(this.drawGoal(h,i))}return d};b.prototype.drawEvents=function(){var i,g,h,e,c,f,d;f=this.events;d=[];for(h=e=0,c=f.length;e<c;h=++e){g=f[h];i=this.options.eventLineColors[h%this.options.eventLineColors.length];d.push(this.drawEvent(g,i))}return d};b.prototype.drawGoal=function(c,d){return this.raphael.path("M"+this.left+","+(this.transY(c))+"H"+this.right).attr("stroke",d).attr("stroke-width",this.options.goalStrokeWidth)};b.prototype.drawEvent=function(c,d){return this.raphael.path("M"+(this.transX(c))+","+this.bottom+"V"+this.top).attr("stroke",d).attr("stroke-width",this.options.eventStrokeWidth)};b.prototype.drawYAxisLabel=function(e,d,c){return this.raphael.text(e,d,c).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor).attr("text-anchor","end")};b.prototype.drawGridLine=function(c){return this.raphael.path(c).attr("stroke",this.options.gridLineColor).attr("stroke-width",this.options.gridStrokeWidth)};b.prototype.startRange=function(c){this.hover.hide();this.selectFrom=c;return this.selectionRect.attr({x:c,width:0}).show()};b.prototype.endRange=function(d){var c,e;if(this.selectFrom){e=Math.min(this.selectFrom,d);c=Math.max(this.selectFrom,d);this.options.rangeSelect.call(this.el,{start:this.data[this.hitTest(e)].x,end:this.data[this.hitTest(c)].x});return this.selectFrom=null}};b.prototype.resizeHandler=function(){this.timeoutId=null;this.raphael.setSize(this.el.width(),this.el.height());return this.redraw()};return b})(n.EventEmitter);n.parseDate=function(i){var g,h,c,B,C,a,D,b,d,e,f;if(typeof i==="number"){return i}h=i.match(/^(\d+) Q(\d)$/);B=i.match(/^(\d+)-(\d+)$/);C=i.match(/^(\d+)-(\d+)-(\d+)$/);D=i.match(/^(\d+) W(\d+)$/);b=i.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+)(Z|([+-])(\d\d):?(\d\d))?$/);d=i.match(/^(\d+)-(\d+)-(\d+)[ T](\d+):(\d+):(\d+(\.\d+)?)(Z|([+-])(\d\d):?(\d\d))?$/);if(h){return new Date(parseInt(h[1],10),parseInt(h[2],10)*3-1,1).getTime()}else{if(B){return new Date(parseInt(B[1],10),parseInt(B[2],10)-1,1).getTime()}else{if(C){return new Date(parseInt(C[1],10),parseInt(C[2],10)-1,parseInt(C[3],10)).getTime()}else{if(D){e=new Date(parseInt(D[1],10),0,1);if(e.getDay()!==4){e.setMonth(0,1+((4-e.getDay())+7)%7)}return e.getTime()+parseInt(D[2],10)*604800000}else{if(b){if(!b[6]){return new Date(parseInt(b[1],10),parseInt(b[2],10)-1,parseInt(b[3],10),parseInt(b[4],10),parseInt(b[5],10)).getTime()}else{a=0;if(b[6]!=="Z"){a=parseInt(b[8],10)*60+parseInt(b[9],10);if(b[7]==="+"){a=0-a}}return Date.UTC(parseInt(b[1],10),parseInt(b[2],10)-1,parseInt(b[3],10),parseInt(b[4],10),parseInt(b[5],10)+a)}}else{if(d){f=parseFloat(d[6]);g=Math.floor(f);c=Math.round((f-g)*1000);if(!d[8]){return new Date(parseInt(d[1],10),parseInt(d[2],10)-1,parseInt(d[3],10),parseInt(d[4],10),parseInt(d[5],10),g,c).getTime()}else{a=0;if(d[8]!=="Z"){a=parseInt(d[10],10)*60+parseInt(d[11],10);if(d[9]==="+"){a=0-a}}return Date.UTC(parseInt(d[1],10),parseInt(d[2],10)-1,parseInt(d[3],10),parseInt(d[4],10),parseInt(d[5],10)+a,g,c)}}else{return new Date(parseInt(i,10),0,1).getTime()}}}}}}};n.Hover=(function(){a.defaults={"class":"morris-hover morris-default-style"};function a(b){if(b==null){b={}}this.options=p.extend({},n.Hover.defaults,b);this.el=p("<div class='"+this.options["class"]+"'></div>");this.el.hide();this.options.parent.append(this.el)}a.prototype.update=function(c,d,b){if(!c){return this.hide()}else{this.html(c);this.show();return this.moveTo(d,b)}};a.prototype.html=function(b){return this.el.html(b)};a.prototype.moveTo=function(c,e){var d,h,f,b,i,g;i=this.options.parent.innerWidth();b=this.options.parent.innerHeight();h=this.el.outerWidth();d=this.el.outerHeight();f=Math.min(Math.max(0,c-h/2),i-h);if(e!=null){g=e-d-10;if(g<0){g=e+10;if(g+d>b){g=b/2-d/2}}}else{g=b/2-d/2}return this.el.css({left:f+"px",top:parseInt(g)+"px"})};a.prototype.show=function(){return this.el.show()};a.prototype.hide=function(){return this.el.hide()};return a})();n.Line=(function(b){q(a,b);function a(c){this.hilight=m(this.hilight,this);this.onHoverOut=m(this.onHoverOut,this);this.onHoverMove=m(this.onHoverMove,this);this.onGridClick=m(this.onGridClick,this);if(!(this instanceof n.Line)){return new n.Line(c)}a.__super__.constructor.call(this,c)}a.prototype.init=function(){if(this.options.hideHover!=="always"){this.hover=new n.Hover({parent:this.el});this.on("hovermove",this.onHoverMove);this.on("hoverout",this.onHoverOut);return this.on("gridclick",this.onGridClick)}};a.prototype.defaults={lineWidth:3,pointSize:4,lineColors:["#0b62a4","#7A92A3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],pointStrokeWidths:[1],pointStrokeColors:["#ffffff"],pointFillColors:[],smooth:true,xLabels:"auto",xLabelFormat:null,xLabelMargin:24,hideHover:false};a.prototype.calc=function(){this.calcPoints();return this.generatePaths()};a.prototype.calcPoints=function(){var f,e,g,c,h,d;h=this.data;d=[];for(g=0,c=h.length;g<c;g++){f=h[g];f._x=this.transX(f.x);f._y=(function(){var i,w,x,v;x=f.y;v=[];for(i=0,w=x.length;i<w;i++){e=x[i];if(e!=null){v.push(this.transY(e))}else{v.push(e)}}return v}).call(this);d.push(f._ymax=Math.min.apply(Math,[this.bottom].concat((function(){var i,w,x,v;x=f._y;v=[];for(i=0,w=x.length;i<w;i++){e=x[i];if(e!=null){v.push(e)}}return v})())))}return d};a.prototype.hitTest=function(d){var h,g,e,c,f;if(this.data.length===0){return null}f=this.data.slice(1);for(h=e=0,c=f.length;e<c;h=++e){g=f[h];if(d<(g._x+this.data[h]._x)/2){break}}return h};a.prototype.onGridClick=function(d,e){var c;c=this.hitTest(d);return this.fire("click",c,this.data[c].src,d,e)};a.prototype.onHoverMove=function(d,e){var c;c=this.hitTest(d);return this.displayHoverForRow(c)};a.prototype.onHoverOut=function(){if(this.options.hideHover!==false){return this.displayHoverForRow(null)}};a.prototype.displayHoverForRow=function(d){var c;if(d!=null){(c=this.hover).update.apply(c,this.hoverContentForRow(d));return this.hilight(d)}else{this.hover.hide();return this.hilight()}};a.prototype.hoverContentForRow=function(t){var i,c,f,e,g,d,h;f=this.data[t];i="<div class='morris-hover-row-label'>"+f.label+"</div>";h=f.y;for(c=g=0,d=h.length;g<d;c=++g){e=h[c];i+="<div class='morris-hover-point' style='color: "+(this.colorFor(f,c,"label"))+"'>\n  "+this.options.labels[c]+":\n  "+(this.yLabelFormat(e))+"\n</div>"}if(typeof this.options.hoverCallback==="function"){i=this.options.hoverCallback(t,this.options,i,f.src)}return[i,f._x,f._ymax]};a.prototype.generatePaths=function(){var e,c,f,d;return this.paths=(function(){var g,h,t,i;i=[];for(c=g=0,h=this.options.ykeys.length;0<=h?g<h:g>h;c=0<=h?++g:--g){d=typeof this.options.smooth==="boolean"?this.options.smooth:(t=this.options.ykeys[c],j.call(this.options.smooth,t)>=0);e=(function(){var x,z,s,y;s=this.data;y=[];for(x=0,z=s.length;x<z;x++){f=s[x];if(f._y[c]!==void 0){y.push({x:f._x,y:f._y[c]})}}return y}).call(this);if(e.length>1){i.push(n.Line.createPath(e,d,this.bottom))}else{i.push(null)}}return i}).call(this)};a.prototype.draw=function(){var c;if((c=this.options.axes)===true||c==="both"||c==="x"){this.drawXAxis()}this.drawSeries();if(this.options.hideHover===false){return this.displayHoverForRow(this.data.length-1)}};a.prototype.drawXAxis=function(){var y,f,c,h,z,i,g,d,x,e,A=this;g=this.bottom+this.options.padding/2;z=null;h=null;y=function(w,u){var t,E,s,v,D;t=A.drawXAxisLabel(A.transX(u),g,w);D=t.getBBox();t.transform("r"+(-A.options.xLabelAngle));E=t.getBBox();t.transform("t0,"+(E.height/2)+"...");if(A.options.xLabelAngle!==0){v=-0.5*D.width*Math.cos(A.options.xLabelAngle*Math.PI/180);t.transform("t"+v+",0...")}E=t.getBBox();if(((z==null)||z>=E.x+E.width||(h!=null)&&h>=E.x)&&E.x>=0&&(E.x+E.width)<A.el.width()){if(A.options.xLabelAngle!==0){s=1.25*A.options.gridTextSize/Math.sin(A.options.xLabelAngle*Math.PI/180);h=E.x-s}return z=E.x-A.options.xLabelMargin}else{return t.remove()}};if(this.options.parseTime){if(this.data.length===1&&this.options.xLabels==="auto"){c=[[this.data[0].label,this.data[0].x]]}else{c=n.labelSeries(this.xmin,this.xmax,this.width,this.options.xLabels,this.options.xLabelFormat)}}else{c=(function(){var u,s,v,t;v=this.data;t=[];for(u=0,s=v.length;u<s;u++){i=v[u];t.push([i.label,i.x])}return t}).call(this)}c.reverse();e=[];for(d=0,x=c.length;d<x;d++){f=c[d];e.push(y(f[0],f[1]))}return e};a.prototype.drawSeries=function(){var h,e,g,f,d,c;this.seriesPoints=[];for(h=e=f=this.options.ykeys.length-1;f<=0?e<=0:e>=0;h=f<=0?++e:--e){this._drawLineFor(h)}c=[];for(h=g=d=this.options.ykeys.length-1;d<=0?g<=0:g>=0;h=d<=0?++g:--g){c.push(this._drawPointFor(h))}return c};a.prototype._drawPointFor=function(i){var f,e,g,c,h,d;this.seriesPoints[i]=[];h=this.data;d=[];for(g=0,c=h.length;g<c;g++){e=h[g];f=null;if(e._y[i]!=null){f=this.drawLinePoint(e._x,e._y[i],this.colorFor(e,i,"point"),i)}d.push(this.seriesPoints[i].push(f))}return d};a.prototype._drawLineFor=function(d){var c;c=this.paths[d];if(c!==null){return this.drawLinePath(c,this.colorFor(null,d,"line"),d)}};a.createPath=function(E,i,D){var J,K,I,L,f,h,e,d,g,C,F,H,c,G;e="";if(i){I=n.Line.gradients(E)}d={y:null};for(L=c=0,G=E.length;c<G;L=++c){J=E[L];if(J.y!=null){if(d.y!=null){if(i){K=I[L];h=I[L-1];f=(J.x-d.x)/4;g=d.x+f;F=Math.min(D,d.y+f*h);C=J.x-f;H=Math.min(D,J.y-f*K);e+="C"+g+","+F+","+C+","+H+","+J.x+","+J.y}else{e+="L"+J.x+","+J.y}}else{if(!i||(I[L]!=null)){e+="M"+J.x+","+J.y}}}d=J}return e};a.gradients=function(c){var d,u,f,e,i,g,v,h;u=function(s,t){return(s.y-t.y)/(s.x-t.x)};h=[];for(f=g=0,v=c.length;g<v;f=++g){d=c[f];if(d.y!=null){e=c[f+1]||{y:null};i=c[f-1]||{y:null};if((i.y!=null)&&(e.y!=null)){h.push(u(i,e))}else{if(i.y!=null){h.push(u(i,d))}else{if(e.y!=null){h.push(u(d,e))}else{h.push(null)}}}}else{h.push(null)}}return h};a.prototype.hilight=function(c){var h,e,g,f,d;if(this.prevHilight!==null&&this.prevHilight!==c){for(h=e=0,f=this.seriesPoints.length-1;0<=f?e<=f:e>=f;h=0<=f?++e:--e){if(this.seriesPoints[h][this.prevHilight]){this.seriesPoints[h][this.prevHilight].animate(this.pointShrinkSeries(h))}}}if(c!==null&&this.prevHilight!==c){for(h=g=0,d=this.seriesPoints.length-1;0<=d?g<=d:g>=d;h=0<=d?++g:--g){if(this.seriesPoints[h][c]){this.seriesPoints[h][c].animate(this.pointGrowSeries(h))}}}return this.prevHilight=c};a.prototype.colorFor=function(e,c,d){if(typeof this.options.lineColors==="function"){return this.options.lineColors.call(this,e,c,d)}else{if(d==="point"){return this.options.pointFillColors[c%this.options.pointFillColors.length]||this.options.lineColors[c%this.options.lineColors.length]}else{return this.options.lineColors[c%this.options.lineColors.length]}}};a.prototype.drawXAxisLabel=function(e,d,c){return this.raphael.text(e,d,c).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};a.prototype.drawLinePath=function(c,d,e){return this.raphael.path(c).attr("stroke",d).attr("stroke-width",this.lineWidthForSeries(e))};a.prototype.drawLinePoint=function(e,c,d,f){return this.raphael.circle(e,c,this.pointSizeForSeries(f)).attr("fill",d).attr("stroke-width",this.pointStrokeWidthForSeries(f)).attr("stroke",this.pointStrokeColorForSeries(f))};a.prototype.pointStrokeWidthForSeries=function(c){return this.options.pointStrokeWidths[c%this.options.pointStrokeWidths.length]};a.prototype.pointStrokeColorForSeries=function(c){return this.options.pointStrokeColors[c%this.options.pointStrokeColors.length]};a.prototype.lineWidthForSeries=function(c){if(this.options.lineWidth instanceof Array){return this.options.lineWidth[c%this.options.lineWidth.length]}else{return this.options.lineWidth}};a.prototype.pointSizeForSeries=function(c){if(this.options.pointSize instanceof Array){return this.options.pointSize[c%this.options.pointSize.length]}else{return this.options.pointSize}};a.prototype.pointGrowSeries=function(c){return Raphael.animation({r:this.pointSizeForSeries(c)+3},25,"linear")};a.prototype.pointShrinkSeries=function(c){return Raphael.animation({r:this.pointSizeForSeries(c)},25,"linear")};return a})(n.Grid);n.labelSeries=function(g,F,b,s,B){var a,h,D,i,c,e,C,t,f,E,d;D=200*(F-g)/b;h=new Date(g);C=n.LABEL_SPECS[s];if(C===void 0){d=n.AUTO_LABEL_ORDER;for(f=0,E=d.length;f<E;f++){i=d[f];e=n.LABEL_SPECS[i];if(D>=e.span){C=e;break}}}if(C===void 0){C=n.LABEL_SPECS.second}if(B){C=p.extend({},C,{fmt:B})}a=C.start(h);c=[];while((t=a.getTime())<=F){if(t>=g){c.push([C.fmt(a),t])}C.incr(a)}return c};r=function(a){return{span:a*60*1000,start:function(b){return new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours())},fmt:function(b){return""+(n.pad2(b.getHours()))+":"+(n.pad2(b.getMinutes()))},incr:function(b){return b.setUTCMinutes(b.getUTCMinutes()+a)}}};k=function(a){return{span:a*1000,start:function(b){return new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes())},fmt:function(b){return""+(n.pad2(b.getHours()))+":"+(n.pad2(b.getMinutes()))+":"+(n.pad2(b.getSeconds()))},incr:function(b){return b.setUTCSeconds(b.getUTCSeconds()+a)}}};n.LABEL_SPECS={decade:{span:172800000000,start:function(a){return new Date(a.getFullYear()-a.getFullYear()%10,0,1)},fmt:function(a){return""+(a.getFullYear())},incr:function(a){return a.setFullYear(a.getFullYear()+10)}},year:{span:17280000000,start:function(a){return new Date(a.getFullYear(),0,1)},fmt:function(a){return""+(a.getFullYear())},incr:function(a){return a.setFullYear(a.getFullYear()+1)}},month:{span:2419200000,start:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},fmt:function(a){return""+(a.getFullYear())+"-"+(n.pad2(a.getMonth()+1))},incr:function(a){return a.setMonth(a.getMonth()+1)}},week:{span:604800000,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return""+(a.getFullYear())+"-"+(n.pad2(a.getMonth()+1))+"-"+(n.pad2(a.getDate()))},incr:function(a){return a.setDate(a.getDate()+7)}},day:{span:86400000,start:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},fmt:function(a){return""+(a.getFullYear())+"-"+(n.pad2(a.getMonth()+1))+"-"+(n.pad2(a.getDate()))},incr:function(a){return a.setDate(a.getDate()+1)}},hour:r(60),"30min":r(30),"15min":r(15),"10min":r(10),"5min":r(5),minute:r(1),"30sec":k(30),"15sec":k(15),"10sec":k(10),"5sec":k(5),second:k(1)};n.AUTO_LABEL_ORDER=["decade","year","month","week","day","hour","30min","15min","10min","5min","minute","30sec","15sec","10sec","5sec","second"];n.Area=(function(a){var c;q(b,a);c={fillOpacity:"auto",behaveLikeLine:false};function b(e){var d;if(!(this instanceof n.Area)){return new n.Area(e)}d=p.extend({},c,e);this.cumulative=!d.behaveLikeLine;if(d.fillOpacity==="auto"){d.fillOpacity=d.behaveLikeLine?0.8:1}b.__super__.constructor.call(this,d)}b.prototype.calcPoints=function(){var f,i,e,g,t,h,d;h=this.data;d=[];for(g=0,t=h.length;g<t;g++){f=h[g];f._x=this.transX(f.x);i=0;f._y=(function(){var s,y,z,x;z=f.y;x=[];for(s=0,y=z.length;s<y;s++){e=z[s];if(this.options.behaveLikeLine){x.push(this.transY(e))}else{i+=e||0;x.push(this.transY(i))}}return x}).call(this);d.push(f._ymax=Math.max.apply(Math,f._y))}return d};b.prototype.drawSeries=function(){var z,y,B,e,h,x,A,d,f,g,i;this.seriesPoints=[];if(this.options.behaveLikeLine){y=(function(){f=[];for(var t=0,s=this.options.ykeys.length-1;0<=s?t<=s:t>=s;0<=s?t++:t--){f.push(t)}return f}).apply(this)}else{y=(function(){g=[];for(var s=d=this.options.ykeys.length-1;d<=0?s<=0:s>=0;d<=0?s++:s--){g.push(s)}return g}).apply(this)}i=[];for(h=0,x=y.length;h<x;h++){z=y[h];this._drawFillFor(z);this._drawLineFor(z);i.push(this._drawPointFor(z))}return i};b.prototype._drawFillFor=function(d){var e;e=this.paths[d];if(e!==null){e=e+("L"+(this.transX(this.xmax))+","+this.bottom+"L"+(this.transX(this.xmin))+","+this.bottom+"Z");return this.drawFilledPath(e,this.fillForSeries(d))}};b.prototype.fillForSeries=function(e){var d;d=Raphael.rgb2hsl(this.colorFor(this.data[e],e,"line"));return Raphael.hsl(d.h,this.options.behaveLikeLine?d.s*0.9:d.s*0.75,Math.min(0.98,this.options.behaveLikeLine?d.l*1.2:d.l*1.25))};b.prototype.drawFilledPath=function(e,d){return this.raphael.path(e).attr("fill",d).attr("fill-opacity",this.options.fillOpacity).attr("stroke","none")};return b})(n.Line);n.Bar=(function(a){q(b,a);function b(c){this.onHoverOut=m(this.onHoverOut,this);this.onHoverMove=m(this.onHoverMove,this);this.onGridClick=m(this.onGridClick,this);if(!(this instanceof n.Bar)){return new n.Bar(c)}b.__super__.constructor.call(this,p.extend({},c,{parseTime:false}))}b.prototype.init=function(){this.cumulative=this.options.stacked;if(this.options.hideHover!=="always"){this.hover=new n.Hover({parent:this.el});this.on("hovermove",this.onHoverMove);this.on("hoverout",this.onHoverOut);return this.on("gridclick",this.onGridClick)}};b.prototype.defaults={barSizeRatio:0.75,barGap:3,barColors:["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],barOpacity:1,barRadius:[0,0,0,0],xLabelMargin:50};b.prototype.calc=function(){var c;this.calcBars();if(this.options.hideHover===false){return(c=this.hover).update.apply(c,this.hoverContentForRow(this.data.length-1))}};b.prototype.calcBars=function(){var d,f,e,g,i,h,c;h=this.data;c=[];for(d=g=0,i=h.length;g<i;d=++g){f=h[d];f._x=this.left+this.width*(d+0.5)/this.data.length;c.push(f._y=(function(){var w,y,z,x;z=f.y;x=[];for(w=0,y=z.length;w<y;w++){e=z[w];if(e!=null){x.push(this.transY(e))}else{x.push(null)}}return x}).call(this))}return c};b.prototype.draw=function(){var c;if((c=this.options.axes)===true||c==="both"||c==="x"){this.drawXAxis()}return this.drawSeries()};b.prototype.drawXAxis=function(){var D,A,z,f,d,i,C,y,B,h,e,c,g;h=this.bottom+(this.options.xAxisLabelTopPadding||this.options.padding/2);C=null;i=null;g=[];for(D=e=0,c=this.data.length;0<=c?e<c:e>c;D=0<=c?++e:--e){y=this.data[this.data.length-1-D];A=this.drawXAxisLabel(y._x,h,y.label);B=A.getBBox();A.transform("r"+(-this.options.xLabelAngle));z=A.getBBox();A.transform("t0,"+(z.height/2)+"...");if(this.options.xLabelAngle!==0){d=-0.5*B.width*Math.cos(this.options.xLabelAngle*Math.PI/180);A.transform("t"+d+",0...")}if(((C==null)||C>=z.x+z.width||(i!=null)&&i>=z.x)&&z.x>=0&&(z.x+z.width)<this.el.width()){if(this.options.xLabelAngle!==0){f=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180);i=z.x-f}g.push(C=z.x-this.options.xLabelMargin)}else{g.push(A.remove())}}return g};b.prototype.drawSeries=function(){var A,i,d,E,G,f,h,c,B,F,C,e,H,g,D;d=this.width/this.options.data.length;c=this.options.stacked?1:this.options.ykeys.length;A=(d*this.options.barSizeRatio-this.options.barGap*(c-1))/c;if(this.options.barSize){A=Math.min(A,this.options.barSize)}e=d-A*c-this.options.barGap*(c-1);h=e/2;D=this.ymin<=0&&this.ymax>=0?this.transY(0):null;return this.bars=(function(){var t,v,u,s;u=this.data;s=[];for(E=t=0,v=u.length;t<v;E=++t){B=u[E];G=0;s.push((function(){var w,y,z,x;z=B._y;x=[];for(F=w=0,y=z.length;w<y;F=++w){g=z[F];if(g!==null){if(D){H=Math.min(g,D);i=Math.max(g,D)}else{H=g;i=this.bottom}f=this.left+E*d+h;if(!this.options.stacked){f+=F*(A+this.options.barGap)}C=i-H;if(this.options.verticalGridCondition&&this.options.verticalGridCondition(B.x)){this.drawBar(this.left+E*d,this.top,d,Math.abs(this.top-this.bottom),this.options.verticalGridColor,this.options.verticalGridOpacity,this.options.barRadius)}if(this.options.stacked){H-=G}this.drawBar(f,H,A,C,this.colorFor(B,F,"bar"),this.options.barOpacity,this.options.barRadius);x.push(G+=C)}else{x.push(null)}}return x}).call(this))}return s}).call(this)};b.prototype.colorFor=function(e,f,c){var g,d;if(typeof this.options.barColors==="function"){g={x:e.x,y:e.y[f],label:e.label};d={index:f,key:this.options.ykeys[f],label:this.options.labels[f]};return this.options.barColors.call(this,g,d,c)}else{return this.options.barColors[f%this.options.barColors.length]}};b.prototype.hitTest=function(c){if(this.data.length===0){return null}c=Math.max(Math.min(c,this.right),this.left);return Math.min(this.data.length-1,Math.floor((c-this.left)/(this.width/this.data.length)))};b.prototype.onGridClick=function(d,e){var c;c=this.hitTest(d);return this.fire("click",c,this.data[c].src,d,e)};b.prototype.onHoverMove=function(d,e){var c,f;c=this.hitTest(d);return(f=this.hover).update.apply(f,this.hoverContentForRow(c))};b.prototype.onHoverOut=function(){if(this.options.hideHover!==false){return this.hover.hide()}};b.prototype.hoverContentForRow=function(f){var e,h,u,v,d,i,c,g;u=this.data[f];e="<div class='morris-hover-row-label'>"+u.label+"</div>";g=u.y;for(h=i=0,c=g.length;i<c;h=++i){d=g[h];e+="<div class='morris-hover-point' style='color: "+(this.colorFor(u,h,"label"))+"'>\n  "+this.options.labels[h]+":\n  "+(this.yLabelFormat(d))+"\n</div>"}if(typeof this.options.hoverCallback==="function"){e=this.options.hoverCallback(f,this.options,e,u.src)}v=this.left+(f+0.5)*this.width/this.data.length;return[e,v]};b.prototype.drawXAxisLabel=function(e,c,f){var d;return d=this.raphael.text(e,c,f).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)};b.prototype.drawBar=function(f,h,i,v,g,c,d){var e,u;e=Math.max.apply(Math,d);if(e===0||e>v){u=this.raphael.rect(f,h,i,v)}else{u=this.raphael.path(this.roundedRect(f,h,i,v,d))}return u.attr("fill",g).attr("fill-opacity",c).attr("stroke","none")};b.prototype.roundedRect=function(d,e,c,g,f){if(f==null){f=[0,0,0,0]}return["M",d,f[0]+e,"Q",d,e,d+f[0],e,"L",d+c-f[1],e,"Q",d+c,e,d+c,e+f[1],"L",d+c,e+g-f[2],"Q",d+c,e+g,d+c-f[2],e+g,"L",d+f[3],e+g,"Q",d,e+g,d,e+g-f[3],"Z"]};return b})(n.Grid);n.Donut=(function(a){q(b,a);b.prototype.defaults={colors:["#0B62A4","#3980B5","#679DC6","#95BBD7","#B0CCE1","#095791","#095085","#083E67","#052C48","#042135"],backgroundColor:"#FFFFFF",labelColor:"#000000",formatter:n.commas,resize:false};function b(d){this.resizeHandler=m(this.resizeHandler,this);this.select=m(this.select,this);this.click=m(this.click,this);var c=this;if(!(this instanceof n.Donut)){return new n.Donut(d)}this.options=p.extend({},this.defaults,d);if(typeof d.element==="string"){this.el=p(document.getElementById(d.element))}else{this.el=p(d.element)}if(this.el===null||this.el.length===0){throw new Error("Graph placeholder not found.")}if(d.data===void 0||d.data.length===0){return}this.raphael=new Raphael(this.el[0]);if(this.options.resize){p(window).bind("resize",function(e){if(c.timeoutId!=null){window.clearTimeout(c.timeoutId)}return c.timeoutId=window.setTimeout(c.resizeHandler,100)})}this.setData(d.data)}b.prototype.redraw=function(){var c,N,R,L,e,w,M,O,T,K,d,Q,g,U,W,X,i,f,h,C,P,S,V;this.raphael.clear();N=this.el.width()/2;R=this.el.height()/2;g=(Math.min(N,R)-10)/3;d=0;C=this.values;for(U=0,i=C.length;U<i;U++){Q=C[U];d+=Q}O=5/(2*g);c=1.9999*Math.PI-O*this.data.length;w=0;e=0;this.segments=[];P=this.values;for(L=W=0,f=P.length;W<f;L=++W){Q=P[L];T=w+O+c*(Q/d);K=new n.DonutSegment(N,R,g*2,g,w,T,this.data[L].color||this.options.colors[e%this.options.colors.length],this.options.backgroundColor,e,this.raphael);K.render();this.segments.push(K);K.on("hover",this.select);K.on("click",this.click);w=T;e+=1}this.text1=this.drawEmptyDonutLabel(N,R-10,this.options.labelColor,15,800);this.text2=this.drawEmptyDonutLabel(N,R+10,this.options.labelColor,14);M=Math.max.apply(Math,this.values);e=0;S=this.values;V=[];for(X=0,h=S.length;X<h;X++){Q=S[X];if(Q===M){this.select(e);break}V.push(e+=1)}return V};b.prototype.setData=function(d){var c;this.data=d;this.values=(function(){var e,g,f,h;f=this.data;h=[];for(e=0,g=f.length;e<g;e++){c=f[e];h.push(parseFloat(c.value))}return h}).call(this);return this.redraw()};b.prototype.click=function(c){return this.fire("click",c,this.data[c])};b.prototype.select=function(d){var e,i,h,f,c,g;g=this.segments;for(f=0,c=g.length;f<c;f++){i=g[f];i.deselect()}h=this.segments[d];h.select();e=this.data[d];return this.setLabels(e.label,this.options.formatter(e.value,e))};b.prototype.setLabels=function(e,f){var v,x,c,w,d,i,h,g;v=(Math.min(this.el.width()/2,this.el.height()/2)-10)*2/3;w=1.8*v;c=v/2;x=v/3;this.text1.attr({text:e,transform:""});d=this.text1.getBBox();i=Math.min(w/d.width,c/d.height);this.text1.attr({transform:"S"+i+","+i+","+(d.x+d.width/2)+","+(d.y+d.height)});this.text2.attr({text:f,transform:""});h=this.text2.getBBox();g=Math.min(w/h.width,x/h.height);return this.text2.attr({transform:"S"+g+","+g+","+(h.x+h.width/2)+","+h.y})};b.prototype.drawEmptyDonutLabel=function(e,h,c,g,d){var f;f=this.raphael.text(e,h,"").attr("font-size",g).attr("fill",c);if(d!=null){f.attr("font-weight",d)}return f};b.prototype.resizeHandler=function(){this.timeoutId=null;this.raphael.setSize(this.el.width(),this.el.height());return this.redraw()};return b})(n.EventEmitter);n.DonutSegment=(function(a){q(b,a);function b(g,i,v,x,c,d,h,e,f,w){this.cx=g;this.cy=i;this.inner=v;this.outer=x;this.color=h;this.backgroundColor=e;this.index=f;this.raphael=w;this.deselect=m(this.deselect,this);this.select=m(this.select,this);this.sin_p0=Math.sin(c);this.cos_p0=Math.cos(c);this.sin_p1=Math.sin(d);this.cos_p1=Math.cos(d);this.is_long=(d-c)>Math.PI?1:0;this.path=this.calcSegment(this.inner+3,this.inner+this.outer-5);this.selectedPath=this.calcSegment(this.inner+3,this.inner+this.outer);this.hilight=this.calcArc(this.inner)}b.prototype.calcArcPoints=function(c){return[this.cx+c*this.sin_p0,this.cy+c*this.cos_p0,this.cx+c*this.sin_p1,this.cy+c*this.cos_p1]};b.prototype.calcSegment=function(h,i){var x,y,B,c,f,g,z,A,d,e;d=this.calcArcPoints(h),x=d[0],B=d[1],y=d[2],c=d[3];e=this.calcArcPoints(i),f=e[0],z=e[1],g=e[2],A=e[3];return("M"+x+","+B)+("A"+h+","+h+",0,"+this.is_long+",0,"+y+","+c)+("L"+g+","+A)+("A"+i+","+i+",0,"+this.is_long+",1,"+f+","+z)+"Z"};b.prototype.calcArc=function(f){var c,d,g,h,e;e=this.calcArcPoints(f),c=e[0],g=e[1],d=e[2],h=e[3];return("M"+c+","+g)+("A"+f+","+f+",0,"+this.is_long+",0,"+d+","+h)};b.prototype.render=function(){var c=this;this.arc=this.drawDonutArc(this.hilight,this.color);return this.seg=this.drawDonutSegment(this.path,this.color,this.backgroundColor,function(){return c.fire("hover",c.index)},function(){return c.fire("click",c.index)})};b.prototype.drawDonutArc=function(c,d){return this.raphael.path(c).attr({stroke:d,"stroke-width":2,opacity:0})};b.prototype.drawDonutSegment=function(f,e,g,d,c){return this.raphael.path(f).attr({fill:e,stroke:g,"stroke-width":3}).hover(d).click(c)};b.prototype.select=function(){if(!this.selected){this.seg.animate({path:this.selectedPath},150,"<>");this.arc.animate({opacity:1},150,"<>");return this.selected=true}};b.prototype.deselect=function(){if(this.selected){this.seg.animate({path:this.path},150,"<>");this.arc.animate({opacity:0},150,"<>");return this.selected=false}};return b})(n.EventEmitter)}).call(this);